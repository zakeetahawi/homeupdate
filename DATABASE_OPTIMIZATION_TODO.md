# ูุงุฆูุฉ ููุงู ุชุญุณูู ุฃุฏุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช
## Database Performance Optimization TODO List

> **ุชุญุฏูุซ ูุณุชูุฑ**: ูุฑุฌู ุชุญุฏูุซ ูุฐู ุงููุงุฆูุฉ ุจุนุฏ ุฅููุงู ูู ูููุฉ โ

---

## ๐ด ุงููุฑุญูุฉ ุงูุฃููู: ุงูุฅุตูุงุญุงุช ุงูุญุฑุฌุฉ (ุงูุฃุณุจูุน ุงูุฃูู)
**ุงูููุนุฏ ุงูููุงุฆู**: 7 ุฃูุงู ูู ุชุงุฑูุฎ ุงูุจุฏุก  
**ุงูุญุงูุฉ**: โณ ููุฏ ุงูุงูุชุธุงุฑ

### 1. ุฅุตูุงุญ N+1 ูู ุฅุญุตุงุฆูุงุช ุงูููุฏูุจูู
**ุงูุฃููููุฉ**: ๐ด ุนุงููุฉ ุฌุฏุงู  
**ุงูููู**: `/orders/views.py`  
**ุงูููุช ุงูููุฏุฑ**: 4 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **1.1** ูุชุญ ููู `/home/zakee/homeupdate/orders/views.py`
- [ ] **1.2** ุงูุจุญุซ ุนู ุฏุงูุฉ `salesperson_list` (ุญูุงูู ุงูุณุทุฑ 580)
- [ ] **1.3** ุงุณุชุจุฏุงู ุงูููุฏ ุงูุญุงูู ุจุงูููุฏ ุงููุญุณูู:
```python
# ุงุณุชุจุฏุงู ูุฐุง ุงูููุฏ:
for sp in salespersons:
    sp.total_orders = Order.objects.filter(salesperson=sp).count()
    sp.completed_orders = Order.objects.filter(salesperson=sp, status='completed').count()
    sp.pending_orders = Order.objects.filter(salesperson=sp, status='pending').count()
    sp.total_sales = Order.objects.filter(salesperson=sp, status='completed').aggregate(Sum('total_amount'))['total_amount__sum'] or 0

# ุจูุฐุง ุงูููุฏ ุงููุญุณูู:
from django.db.models import Count, Sum, Case, When, Q, DecimalField
from django.db.models.functions import Coalesce

salespersons = Salesperson.objects.select_related('branch').annotate(
    total_orders=Count('orders', distinct=True),
    completed_orders=Count('orders', filter=Q(orders__status='completed'), distinct=True),
    pending_orders=Count('orders', filter=Q(orders__status='pending'), distinct=True),
    total_sales=Coalesce(
        Sum('orders__total_amount', filter=Q(orders__status='completed'), output_field=DecimalField(max_digits=10, decimal_places=2)),
        0
    )
).order_by('-total_sales')
```
- [ ] **1.4** ุงุฎุชุจุงุฑ ุงูููุฏ ุงูุฌุฏูุฏ
- [ ] **1.5** ููุงุณ ุชุญุณู ุงูุฃุฏุงุก (ูุฌุจ ุฃู ููู ูู 4รN ุฅูู 1 ุงุณุชุนูุงู)

---

### 2. ุชุญุณูู ุนุฑุถ ูุงุฆูุฉ ุงูุทูุจุงุช
**ุงูุฃููููุฉ**: ๐ด ุนุงููุฉ ุฌุฏุงู  
**ุงูููู**: `/orders/views.py`  
**ุงูููุช ุงูููุฏุฑ**: 6 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **2.1** ูุชุญ ููู `/home/zakee/homeupdate/orders/views.py`
- [ ] **2.2** ุงูุจุญุซ ุนู ุฏุงูุฉ `order_list` (ุญูุงูู ุงูุณุทุฑ 60)
- [ ] **2.3** ุงุณุชุจุฏุงู ุงูููุฏ ุงูุญุงูู ุจุงูููุฏ ุงููุญุณูู (ุงูุธุฑ ุงูุชูุงุตูู ูู ุงูุชูุฑูุฑ)
- [ ] **2.4** ุฅุถุงูุฉ `select_related` ู `prefetch_related` ุงููุทููุจุฉ
- [ ] **2.5** ุชุญุณูู ุฏุงูุฉ `get_user_orders_queryset`
- [ ] **2.6** ุงุฎุชุจุงุฑ ุงูุนุฑุถ ุงูุฌุฏูุฏ
- [ ] **2.7** ุงูุชุฃูุฏ ูู ุนูู ุฌููุน ุงูููุงุชุฑ ุจุดูู ุตุญูุญ

---

### 3. ุฅุถุงูุฉ ุงูููุงุฑุณ ุงูุญุฑุฌุฉ
**ุงูุฃููููุฉ**: ๐ด ุนุงููุฉ ุฌุฏุงู  
**ุงููููุงุช**: `/orders/models.py`, `/customers/models.py`  
**ุงูููุช ุงูููุฏุฑ**: 3 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **3.1** ูุชุญ ููู `/home/zakee/homeupdate/orders/models.py`
- [ ] **3.2** ุฅุถุงูุฉ ุงูููุงุฑุณ ุงูุฌุฏูุฏุฉ ุฅูู `class Meta` ูู ูููุฐุฌ `Order`:
```python
# ุฅุถุงูุฉ ูุฐู ุงูููุงุฑ๏ฟฝ๏ฟฝ:
models.Index(fields=['order_status', 'order_date'], name='order_status_date_idx'),
models.Index(fields=['branch', 'order_date', 'order_status'], name='order_branch_date_status_idx'),
models.Index(fields=['customer', 'created_at'], name='order_customer_created_idx'),
models.Index(fields=['payment_verified', 'order_status'], name='order_payment_status_idx'),
```
- [ ] **3.3** ูุชุญ ููู `/home/zakee/homeupdate/customers/models.py`
- [ ] **3.4** ุฅุถุงูุฉ ุงูููุงุฑุณ ุงูุฌุฏูุฏุฉ ุฅูู ูููุฐุฌ `Customer`
- [ ] **3.5** ุชุดุบูู `python manage.py makemigrations`
- [ ] **3.6** ุชุดุบูู `python manage.py migrate`
- [ ] **3.7** ุงูุชุญูู ูู ุฅูุดุงุก ุงูููุงุฑุณ ุจูุฌุงุญ

---

### 4. ุชุญุณูู ุนุฑุถ ุชูุงุตูู ุงูุทูุจ
**ุงูุฃููููุฉ**: ๐ด ุนุงููุฉ  
**ุงูููู**: `/orders/views.py`  
**ุงูููุช ุงูููุฏุฑ**: 4 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **4.1** ุงูุจุญุซ ุนู ุฏุงูุฉ `order_detail` ูู `/orders/views.py`
- [ ] **4.2** ุงุณุชุจุฏุงู ุงูููุฏ ุจุงููุณุฎุฉ ุงููุญุณููุฉ (ุงูุธุฑ ุงูุชูุฑูุฑ)
- [ ] **4.3** ุฅุถุงูุฉ `Prefetch` ููุนูุงูุงุช ุงููุนูุฏุฉ
- [ ] **4.4** ุงุฎุชุจุงุฑ ุนุฑุถ ุชูุงุตูู ุงูุทูุจ
- [ ] **4.5** ุงูุชุฃูุฏ ูู ุนูู ุฌููุน ุงูุฑูุงุจุท ูุงูุจูุงูุงุช

---

## ๐ก ุงููุฑุญูุฉ ุงูุซุงููุฉ: ุงูุชุญุณููุงุช ุงููุชูุณุทุฉ (ุงูุฃุณุจูุน ุงูุซุงูู)
**ุงูููุนุฏ ุงูููุงุฆู**: 14 ููู ูู ุชุงุฑูุฎ ุงูุจุฏุก  
**ุงูุญุงูุฉ**: โณ ููุฏ ุงูุงูุชุธุงุฑ

### 5. ุชุญุณูู ุชูุงุฑูุฑ ุงููุฎุฒูู
**ุงูุฃููููุฉ**: ๐ก ุนุงููุฉ  
**ุงูููู**: `/reports/views.py`  
**ุงูููุช ุงูููุฏุฑ**: 5 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **5.1** ูุชุญ ููู `/home/zakee/homeupdate/reports/views.py`
- [ ] **5.2** ุงูุจุญุซ ุนู ุฏุงูุฉ `generate_inventory_report`
- [ ] **5.3** ุงุณุชุจุฏุงู ุงูููุฏ ุจุงููุณุฎุฉ ุงููุญุณููุฉ ุงูุชู ุชุณุชุฎุฏู `aggregate`
- [ ] **5.4** ุงุฎุชุจุงุฑ ุงูุชูุฑูุฑ ุงูุฌุฏูุฏ
- [ ] **5.5** ููุงุฑูุฉ ุงูุฃุฏุงุก (ูุจู ูุจุนุฏ)

---

### 6. ุฅูุดุงุก ุฏูุงู ูุณุงุนุฏุฉ ููุจุญุซ
**ุงูุฃููููุฉ**: ๐ก ุนุงููุฉ  
**ุงูููู ุงูุฌุฏูุฏ**: `/orders/utils.py`  
**ุงูููุช ุงูููุฏุฑ**: 3 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **6.1** ุฅูุดุงุก ููู ุฌุฏูุฏ `/home/zakee/homeupdate/orders/utils.py`
- [ ] **6.2** ุฅุถุงูุฉ ุฏุงูุฉ `get_customer_by_param` (ุงูุธุฑ ุงูุชูุฑูุฑ)
- [ ] **6.3** ุฅุถุงูุฉ ุฏุงูุฉ `invalidate_customer_cache`
- [ ] **6.4** ุงุณุชุจุฏุงู ุงุณุชุฎุฏุงูุงุช ุงูุจุญุซ ุงูููุฑุฑุฉ ูู ุงูู views
- [ ] **6.5** ุงุฎุชุจุงุฑ ุงูุฏูุงู ุงูุฌุฏูุฏุฉ

---

### 7. ุชุทุจูู ุงูุชุฎุฒูู ุงููุคูุช
**ุงูุฃููููุฉ**: ๐ก ูุชูุณุทุฉ  
**ุงููููุงุช**: ูุชุนุฏุฏุฉ  
**ุงูููุช ุงูููุฏุฑ**: 4 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **7.1** ุงูุชุฃูุฏ ูู ุชูููู Redis ูู `settings.py`
- [ ] **7.2** ุฅุถุงูุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุญุงูุงุช ุงูุทูุจุงุช
- [ ] **7.3** ุฅุถุงูุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุนููุงุก
- [ ] **7.4** ุฅุถุงูุฉ ุขููุฉ ุฅูุบุงุก ุงูุชุฎุฒูู ุงููุคูุช ุนูุฏ ุงูุชุญุฏูุซ
- [ ] **7.5** ุงุฎุชุจุงุฑ ุงูุชุฎุฒูู ุงููุคูุช

---

### 8. ุฅุถุงูุฉ ุงูููุงุฑุณ ุงููุชุจููุฉ
**ุงูุฃููููุฉ**: ๐ก ูุชูุณุทุฉ  
**ุงููููุงุช**: `/orders/models.py`, `/customers/models.py`  
**ุงูููุช ุงูููุฏุฑ**: 2 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **8.1** ุฅุถุงูุฉ ุงูููุงุฑุณ ุงูุฅุถุงููุฉ ุงููุฐููุฑุฉ ูู ุงูุชูุฑูุฑ
- [ ] **8.2** ุฅูุดุงุก migration ุฌุฏูุฏ
- [ ] **8.3** ุชุทุจูู ุงูู migration
- [ ] **8.4** ูุฑุงูุจุฉ ุฃุฏุงุก ุงูููุงุฑุณ ุงูุฌุฏูุฏุฉ

---

## ๐ข ุงููุฑุญูุฉ ุงูุซุงูุซุฉ: ุงูุชุญุณููุงุช ุงูุฅุถุงููุฉ (ุงูุฃุณุจูุน ุงูุซุงูุซ)
**ุงูููุนุฏ ุงูููุงุฆู**: 21 ููู ูู ุชุงุฑูุฎ ุงูุจุฏุก  
**ุงูุญุงูุฉ**: โณ ููุฏ ุงูุงูุชุธุงุฑ

### 9. ุฅุถุงูุฉ ูุฑุงูุจุฉ ุงูุฃุฏุงุก
**ุงูุฃููููุฉ**: ๐ข ูุชูุณุทุฉ  
**ุงููููุงุช**: `settings.py`, ูููุงุช ุฌุฏูุฏุฉ  
**ุงูููุช ุงูููุฏุฑ**: 4 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **9.1** ุชุซุจูุช Django Debug Toolbar
- [ ] **9.2** ุฅุถุงูุฉ ุฅุนุฏุงุฏุงุช ุงููุฑุงูุจุฉ ูู `settings.py`
- [ ] **9.3** ุฅูุดุงุก middleware ููุฑุงูุจุฉ ุงูุงุณุชุนูุงูุงุช
- [ ] **9.4** ุฅุถุงูุฉ ุชุณุฌูู ููุงุณุชุนูุงูุงุช ุงูุจุทูุฆุฉ
- [ ] **9.5** ุฅูุดุงุก dashboard ููุฑุงูุจุฉ ุงูุฃุฏุงุก

---

### 10. ุชุญุณููุงุช ุฅุถุงููุฉ
**ุงูุฃููููุฉ**: ๐ข ููุฎูุถุฉ  
**ุงููููุงุช**: ูุชุนุฏุฏุฉ  
**ุงูููุช ุงูููุฏุฑ**: 6 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **10.1** ุชุญุณูู ุงุณุชุนูุงูุงุช Dashboard
- [ ] **10.2** ุชุญุณูู ุงุณุชุนูุงูุงุช ุงูุชูุงุฑูุฑ ุงูุฃุฎุฑู
- [ ] **10.3** ุฅุถุงูุฉ pagination ูุญุณูู
- [ ] **10.4** ุชุญุณูู ุงุณุชุนูุงูุงุช ุงูุจุญุซ
- [ ] **10.5** ูุฑุงุฌุนุฉ ูุชุญุณูู ุงูุงุณุชุนูุงูุงุช ุงููุชุจููุฉ

---

### 11. ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก ุงูุดุงูู
**ุงูุฃููููุฉ**: ๐ข ุนุงููุฉ  
**ุงูุฃุฏูุงุช**: Django Debug Toolbar, PostgreSQL EXPLAIN  
**ุงูููุช ุงูููุฏุฑ**: 4 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **11.1** ููุงุณ ุนุฏุฏ ุงูุงุณุชุนูุงูุงุช ูู ุงูุตูุญุงุช ุงูุฑุฆูุณูุฉ
- [ ] **11.2** ููุงุณ ุฃููุงุช ุงูุงุณุชุฌุงุจุฉ
- [ ] **11.3** ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก ุชุญุช ุงูุถุบุท
- [ ] **11.4** ููุงุฑูุฉ ุงููุชุงุฆุฌ ูุน ุงููุถุน ุงูุณุงุจู
- [ ] **11.5** ุชูุซูู ุงููุชุงุฆุฌ

---

### 12. ุชูุซูู ุงูุชุบููุฑุงุช
**ุงูุฃููููุฉ**: ๐ข ุนุงููุฉ  
**ุงููููุงุช**: ูููุงุช ุชูุซูู ุฌุฏูุฏุฉ  
**ุงูููุช ุงูููุฏุฑ**: 3 ุณุงุนุงุช  
**ุงูุญุงูุฉ**: โณ ูู ูุจุฏุฃ

#### ุงูููุงู ุงููุฑุนูุฉ:
- [ ] **12.1** ุชูุซูู ุฌููุน ุงูุชุบููุฑุงุช ุงููุทุจูุฉ
- [ ] **12.2** ุฅูุดุงุก ุฏููู ุงูุตูุงูุฉ
- [ ] **12.3** ุชูุซูู ุฃูุถู ุงูููุงุฑุณุงุช ุงูุฌุฏูุฏุฉ
- [ ] **12.4** ุฅูุดุงุก checklist ูููุฑุงุฌุนุงุช ุงููุณุชูุจููุฉ
- [ ] **12.5** ุชุญุฏูุซ documentation ุงูุฎุงุต ุจุงููุดุฑูุน

---

## ๐ ูุคุดุฑุงุช ุงูุชูุฏู

### ุฅุญุตุงุฆูุงุช ุงูููุงู
- **ุฅุฌูุงูู ุงูููุงู**: 12 ูููุฉ ุฑุฆูุณูุฉ
- **ุงูููุงู ุงูููุชููุฉ**: 0 โ
- **ุงูููุงู ููุฏ ุงูุชูููุฐ**: 0 ๐
- **ุงูููุงู ุงููุชุจููุฉ**: 12 โณ

### ุฅุญุตุงุฆูุงุช ุงููุฑุงุญู
- **ุงูู๏ฟฝ๏ฟฝุญูุฉ ุงูุฃููู**: 0/4 ููุงู ููุชููุฉ (0%)
- **ุงููุฑุญูุฉ ุงูุซุงููุฉ**: 0/4 ููุงู ููุชููุฉ (0%)
- **ุงููุฑุญูุฉ ุงูุซุงูุซุฉ**: 0/4 ููุงู ููุชููุฉ (0%)

### ุงูููุช ุงูููุฏุฑ
- **ุฅุฌูุงูู ุงูููุช ุงูููุฏุฑ**: 48 ุณุงุนุฉ
- **ุงูููุช ุงููุณุชุบุฑู**: 0 ุณุงุนุฉ
- **ุงูููุช ุงููุชุจูู**: 48 ุณุงุนุฉ

---

## ๐จ ุชูุจููุงุช ูููุฉ

### ูุจู ุงูุจุฏุก:
1. **ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุงููุฉ** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. **ุงุฎุชุจุงุฑ ุฌููุน ุงูุชุบููุฑุงุช ูู ุจูุฆุฉ ุงูุชุทููุฑ** ุฃููุงู
3. **ุงูุชุฃูุฏ ูู ุชููุฑ ุฃุฏูุงุช ุงููุฑุงูุจุฉ** (Django Debug Toolbar)

### ุฃุซูุงุก ุงูุชูููุฐ:
1. **ุชุทุจูู ุงูุชุบููุฑุงุช ุชุฏุฑูุฌูุงู** ูููุณ ุฏูุนุฉ ูุงุญุฏุฉ
2. **ูุฑุงูุจุฉ ุงูุฃุฏุงุก ุจุนุฏ ูู ุชุบููุฑ**
3. **ุงูุงุญุชูุงุธ ุจุณุฌู ููุชุบููุฑุงุช** ุงููุทุจูุฉ

### ุจุนุฏ ุงูุงูุชูุงุก:
1. **ูุฑุงูุจุฉ ุงููุธุงู ููุฏุฉ ุฃุณุจูุน** ููุชุฃูุฏ ูู ุงูุงุณุชูุฑุงุฑ
2. **ููุงุณ ุงูุชุญุณู ูู ุงูุฃุฏุงุก** ูุชูุซููู
3. **ุชุฏุฑูุจ ุงููุฑูู** ุนูู ุงูููุงุฑุณุงุช ุงูุฌุฏูุฏุฉ

---

## ๐ ุณุฌู ุงูุชุญุฏูุซุงุช

| ุงูุชุงุฑูุฎ | ุงููููุฉ | ุงูุญุงูุฉ | ุงูููุงุญุธุงุช |
|---------|--------|---------|-----------|
| ___/___/___ | ุจุฏุก ุงููุดุฑูุน | โณ | ุชู ุฅูุดุงุก ุฎุทุฉ ุงูุนูู |
| ___/___/___ |  |  |  |
| ___/___/___ |  |  |  |

---

**ุขุฎุฑ ุชุญุฏูุซ**: ููุงูุฑ 2025  
**ุงููุณุคูู ุนู ุงูุชุญุฏูุซ**: [ุงุณู ุงููุทูุฑ]  
**ุญุงูุฉ ุงููุดุฑูุน**: ุฌุงูุฒ ููุจุฏุก ๐

> **ููุงุญุธุฉ**: ูุฑุฌู ุชุญุฏูุซ ูุฐุง ุงูููู ุจุงูุชุธุงู ูุชุบููุฑ ุญุงูุฉ ุงูููุงู ูู โณ ุฅูู ๐ (ููุฏ ุงูุชูููุฐ) ุซู ุฅูู โ (ููุชูู)