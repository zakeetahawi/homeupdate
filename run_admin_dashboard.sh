#!/bin/bash

# ุณูุฑูุจุช ุชุดุบูู ุฏุงุด ุจูุฑุฏ ุงูุฅุฏุงุฑุฉ
# Admin Dashboard Run Script

echo -e "\033[1;36m๐ ุจุฏุก ุชุดุบูู ูุธุงู ุงูุฎูุงุฌู ูุน ุฏุงุด ุจูุฑุฏ ุงูุฅุฏุงุฑุฉ...\033[0m"
echo -e "\033[1;33m๐ ูุนูููุงุช ุงููุธุงู:\033[0m"
echo -e "   โข ุฏุงุด ุจูุฑุฏ ุฅุฏุงุฑู ุงุญุชุฑุงูู"
echo -e "   โข ุชุญูููุงุช ุดุงููุฉ ูุฌููุน ุงูุฃูุณุงู"
echo -e "   โข ููุงุชุฑ ูุชูุฏูุฉ ูููุงุฑูุงุช ุฒูููุฉ"
echo -e "   โข ุฑุณูู ุจูุงููุฉ ุชูุงุนููุฉ"
echo -e "   โข ุชุตููู ุญุฏูุซ ููุชุฌุงูุจ"
echo ""

# ุงูุชุญูู ูู ูุฌูุฏ ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
if [ ! -d "venv" ]; then
    echo -e "\033[1;31mโ ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ุบูุฑ ููุฌูุฏุฉ\033[0m"
    echo -e "\033[1;33m๐ก ูุฑุฌู ุฅูุดุงุก ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ุฃููุงู:\033[0m"
    echo -e "   python -m venv venv"
    echo -e "   source venv/bin/activate"
    echo -e "   pip install -r requirements.txt"
    exit 1
fi

# ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
echo -e "\033[1;32mโ ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ...\033[0m"
source venv/bin/activate

# ุงูุชุญูู ูู ุชุซุจูุช Django
if ! python -c "import django" 2>/dev/null; then
    echo -e "\033[1;31mโ Django ุบูุฑ ูุซุจุช\033[0m"
    echo -e "\033[1;33m๐ก ูุฑุฌู ุชุซุจูุช ุงููุชุทูุจุงุช:\033[0m"
    echo -e "   pip install -r requirements.txt"
    exit 1
fi

echo -e "\033[1;32mโ Django ูุซุจุช ุจูุฌุงุญ\033[0m"

# ูุญุต ุงููุธุงู
echo -e "\033[1;34m๐ ูุญุต ุงููุธุงู...\033[0m"
python manage.py check

if [ $? -eq 0 ]; then
    echo -e "\033[1;32mโ ูุญุต ุงููุธุงู ูุฌุญ\033[0m"
else
    echo -e "\033[1;31mโ ูุญุต ุงููุธุงู ูุดู\033[0m"
    exit 1
fi

# ุชุดุบูู ุงููุฌุฑุงุช ุฅุฐุง ูุฒู ุงูุฃูุฑ
echo -e "\033[1;34m๐ ุชุดุบูู ุงููุฌุฑุงุช...\033[0m"
python manage.py migrate

# ุฌูุน ุงููููุงุช ุงูุซุงุจุชุฉ
echo -e "\033[1;34m๐ฆ ุฌูุน ุงููููุงุช ุงูุซุงุจุชุฉ...\033[0m"
python manage.py collectstatic --noinput

echo ""
echo -e "\033[1;35m๐ ุงููุธุงู ุฌุงูุฒ ููุชุดุบูู!\033[0m"
echo ""
echo -e "\033[1;33m๐ ูุนูููุงุช ุงููุตูู:\033[0m"
echo -e "   ๐ ุงูุฑุงุจุท ุงูุฑุฆูุณู: http://localhost:8000"
echo -e "   ๐ ุฏุงุด ุจูุฑุฏ ุงูุฅุฏุงุฑุฉ: http://localhost:8000/admin-dashboard/"
echo -e "   ๐ง ููุญุฉ ุงูุฅุฏุงุฑุฉ: http://localhost:8000/admin/"
echo ""
echo -e "\033[1;33m๐ค ูููุฏุฑุงุก:\033[0m"
echo -e "   โข ุชุณุฌูู ุงูุฏุฎูู ููุณุชุฎุฏู ูุฏูุฑ"
echo -e "   โข ุณูุชู ุงูุชูุฌูู ุชููุงุฆูุงู ููุฏุงุด ุจูุฑุฏ"
echo -e "   โข ุฃู ุงููุตูู ูุจุงุดุฑุฉ ุนุจุฑ /admin-dashboard/"
echo ""
echo -e "\033[1;33m๐ฅ ูููุณุชุฎุฏููู ุงูุนุงุฏููู:\033[0m"
echo -e "   โข ุงููุตูู ููุตูุญุฉ ุงูุฑุฆูุณูุฉ ุงูุนุงุฏูุฉ"
echo -e "   โข ูุง ูููู ุงููุตูู ููุฏุงุด ุจูุฑุฏ ุงูุฅุฏุงุฑู"
echo ""
echo -e "\033[1;36m๐ ุจุฏุก ุชุดุบูู ุงูุฎุงุฏู...\033[0m"
echo -e "\033[1;33m๐ก ุงุถุบุท Ctrl+C ูุฅููุงู ุงูุฎุงุฏู\033[0m"
echo ""

# ุชุดุบูู ุงูุฎุงุฏู
python manage.py runserver 0.0.0.0:8000 