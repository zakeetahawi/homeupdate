{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrahead %}
{{ block.super }}
<style>
    .production-line-form {
        max-width: 1200px;
        margin: 20px auto;
    }
    .items-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        background: white;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .items-table th {
        background: #417690;
        color: white;
        padding: 12px;
        text-align: right;
        font-weight: bold;
    }
    .items-table td {
        padding: 12px;
        border-bottom: 1px solid #ddd;
    }
    .items-table tr:hover {
        background: #f5f5f5;
    }
    .production-line-select {
        width: 100%;
        padding: 6px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 14px;
    }
    .current-line {
        display: inline-block;
        padding: 4px 8px;
        background: #e8f5e9;
        color: #2e7d32;
        border-radius: 3px;
        font-size: 12px;
        margin-bottom: 5px;
    }
    .no-line {
        color: #999;
        font-style: italic;
    }
    .submit-row {
        padding: 15px;
        background: #f8f8f8;
        border-top: 1px solid #ddd;
        text-align: left;
        margin-top: 20px;
    }
    .submit-button {
        background: #417690;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
    }
    .submit-button:hover {
        background: #2e5568;
    }
    .cancel-button {
        background: #999;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        margin-right: 10px;
        text-decoration: none;
        display: inline-block;
    }
    .cancel-button:hover {
        background: #777;
    }
    .info-box {
        background: #e3f2fd;
        border-right: 4px solid #2196f3;
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 4px;
    }
</style>
{% endblock %}

{% block content %}
<div class="production-line-form">
    <h1>{{ title }}</h1>
    
    <div class="info-box">
        <strong>ğŸ“¦ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø£Ù‚Ù…Ø´Ø©:</strong> {{ fabric_receipt.receipt_code }}<br/>
        <strong>ğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„:</strong> {{ fabric_receipt.order.customer.name|default:"-" }}<br/>
        <strong>ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…:</strong> {{ fabric_receipt.receipt_date|date:"Y-m-d" }}<br/>
        <strong>ğŸ’ Ø±Ù‚Ù… Ø§Ù„Ø´Ù†Ø·Ø©:</strong> {{ fabric_receipt.bag_number }}
    </div>

    <form method="post">
        {% csrf_token %}
        
        <table class="items-table">
            <thead>
                <tr>
                    <th style="width: 40%;">Ø§Ù„Ù…Ù†ØªØ¬</th>
                    <th style="width: 10%; text-align: center;">Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                    <th style="width: 25%;">Ø®Ø· Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø­Ø§Ù„ÙŠ</th>
                    <th style="width: 25%;">Ø®Ø· Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø¬Ø¯ÙŠØ¯</th>
                </tr>
            </thead>
            <tbody>
                {% for item_data in items_data %}
                <tr>
                    <td>
                        <strong>{{ item_data.receipt_item.product_name }}</strong>
                    </td>
                    <td style="text-align: center;">
                        {{ item_data.receipt_item.quantity_received }}
                    </td>
                    <td>
                        {% if item_data.current_production_line %}
                            <span class="current-line">
                                âœ“ {{ item_data.current_production_line.name }}
                            </span>
                        {% else %}
                            <span class="no-line">Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯</span>
                        {% endif %}
                    </td>
                    <td>
                        <select name="production_line_{{ item_data.receipt_item.pk }}" class="production-line-select">
                            <option value="">-- Ø§Ø®ØªØ± Ø®Ø· Ø§Ù„Ø¥Ù†ØªØ§Ø¬ --</option>
                            {% for line in production_lines %}
                                <option value="{{ line.pk }}" 
                                    {% if item_data.current_production_line and item_data.current_production_line.pk == line.pk %}selected{% endif %}>
                                    {{ line.name }}
                                </option>
                            {% endfor %}
                        </select>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" style="text-align: center; color: #999; padding: 30px;">
                        Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ± Ù…Ø³ØªÙ„Ù…Ø©
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="submit-row">
            <a href="{% url 'admin:manufacturing_fabricreceipt_change' fabric_receipt.pk %}" class="cancel-button">
                â† Ø¥Ù„ØºØ§Ø¡
            </a>
            <button type="submit" class="submit-button">
                ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª
            </button>
        </div>
    </form>
</div>
{% endblock %}
