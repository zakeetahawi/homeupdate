# ุชุญุณููุงุช ุงูุฃุฏุงุก ููุธุงู ุฅูุดุงุก ุงูุทูุจุงุช ูุงููุนุงููุฉ

## ๐ ููุฎุต ุงููุดุงูู ุงููุญูููุฉ

ุชู ุชุญุฏูุฏ ูุญู ุงููุดุงูู ุงูุชุงููุฉ ุงูุชู ูุงูุช ุชุณุจุจ ุงูุจุทุก ูู ุนูููุฉ ุฅูุดุงุก ุงูุทูุจุงุช ูุงููุนุงููุฉ:

### ๐ ุงููุดุงูู ุงูุฃุณุงุณูุฉ:
1. **ุฑูุน ุงููููุงุช ุงููุชุฒุงูู**: ูุงู ุฑูุน ูููุงุช ุงูุนููุฏ ูุงููุนุงููุงุช ุฅูู Google Drive ูุชู ุจุดูู ูุชุฒุงูู ุฃุซูุงุก ุญูุธ ุงูุทูุจ
2. **ุนูููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุนูุฏุฉ**: ุญุณุงุจุงุช ูุชุนุฏุฏุฉ ููุนูุฏุฉ ุฃุซูุงุก ุญูุธ ุงูุทูุจ
3. **ุนุฏู ูุฌูุฏ ูุคุดุฑุงุช ุชูุฏู**: ุงููุณุชุฎุฏู ูุง ูุนุฑู ูุง ูุญุฏุซ ุฃุซูุงุก ุงููุนุงูุฌุฉ
4. **ุนูููุงุช JavaScript ูุชุฒุงููุฉ**: ุชุญุฏูุซุงุช ูุชูุฑุฑุฉ ูุบูุฑ ูุญุณูุฉ ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
5. **ุนุฏู ูุฌูุฏ ุชุฎุฒูู ูุคูุช**: ุงุณุชุนูุงูุงุช ูุชูุฑุฑุฉ ููุจูุงูุงุช ููุณูุง

---

## ๐ ุงูุญููู ุงููุทุจูุฉ

### 1. ุชุญุณูู ุฑูุน ุงููููุงุช ุฅูู Google Drive

#### โ ูุง ุชู ุชุทุจููู:
- **ููุงู ุฎูููุฉ**: ุชุญููู ุฑูุน ุงููููุงุช ุฅูู ููุงู ุบูุฑ ูุชุฒุงููุฉ ุจุงุณุชุฎุฏุงู Celery
- **ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุงูุชููุงุฆูุฉ**: ูุธุงู ุฅุนุงุฏุฉ ุงููุญุงููุฉ ูู ุญุงูุฉ ูุดู ุงูุฑูุน
- **ุชูุธูู ุฏูุฑู**: ูููุฉ ุฏูุฑูุฉ ูุฅุนุงุฏุฉ ูุญุงููุฉ ุฑูุน ุงููููุงุช ุงููุงุดูุฉ

#### ๐ ุงููููุงุช ุงููุชุฃุซุฑุฉ:
- `orders/tasks.py` - ููุงู Celery ุงูุฌุฏูุฏุฉ
- `orders/models.py` - ุชุญุฏูุซ ุฏุงูุฉ save()
- `orders/views.py` - ุชุญุฏูุซ API ุฑูุน ุงูุนููุฏ
- `inspections/models.py` - ุฅุถุงูุฉ ุฌุฏููุฉ ุงูุฑูุน
- `inspections/views.py` - ุชุญุฏูุซ API ุฑูุน ุงููุนุงููุงุช

#### ๐ง ููููุฉ ุงูุงุณุชุฎุฏุงู:
```python
# ุฑูุน ููู ุนูุฏ ุจุดูู ุบูุฑ ูุชุฒุงูู
from orders.tasks import upload_contract_to_drive_async
upload_contract_to_drive_async.delay(order_id)

# ุฑูุน ููู ูุนุงููุฉ ุจุดูู ุบูุฑ ูุชุฒุงูู
from orders.tasks import upload_inspection_to_drive_async
upload_inspection_to_drive_async.delay(inspection_id)
```

### 2. ุชุญุณูู ุนูููุงุช ุญูุธ ุงูุทูุจุงุช

#### โ ูุง ุชู ุชุทุจููู:
- **ุญุณุงุจุงุช ุบูุฑ ูุชุฒุงููุฉ**: ููู ุญุณุงุจ ุงูุณุนุฑ ุงูููุงุฆู ุฅูู ููุงู ุฎูููุฉ
- **ุชูููู ุงูุงุณุชุนูุงูุงุช**: ุชุญุณูู ุงุณุชุนูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **ุชุญุณูู ุฏุงูุฉ save()**: ุชูููู ุงูุนูููุงุช ุงููุนูุฏุฉ ุฃุซูุงุก ุงูุญูุธ

#### ๐ ุงููููุงุช ุงููุชุฃุซุฑุฉ:
- `orders/models.py` - ุชุญุณูู ุฏูุงู save() ู calculate_final_price()
- `orders/tasks.py` - ูููุฉ ุญุณุงุจ ุงูุฅุฌูุงููุงุช

### 3. ุฅุถุงูุฉ ูุคุดุฑุงุช ุงูุชูุฏู ูุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู

#### โ ูุง ุชู ุชุทุจููู:
- **ูุคุดุฑ ุชูุฏู ูุชูุฏู**: ูุคุดุฑ ุชูุฏู ูุน ุฎุทูุงุช ูุงุถุญุฉ
- **ููุน ุงูุฅุฑุณุงู ุงููุชุนุฏุฏ**: ุญูุงูุฉ ูู ุฅุฑุณุงู ุงููููุฐุฌ ุฃูุซุฑ ูู ูุฑุฉ
- **ููุน ูุบุงุฏุฑุฉ ุงูุตูุญุฉ**: ุชุญุฐูุฑ ุงููุณุชุฎุฏู ุนูุฏ ูุญุงููุฉ ูุบุงุฏุฑุฉ ุงูุตูุญุฉ ุฃุซูุงุก ุงููุนุงูุฌุฉ
- **ุฑุณุงุฆู ุฎุทุฃ ูุญุณูุฉ**: ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูุน ุชูุงุตูู

#### ๐ ุงููููุงุช ุงููุชุฃุซุฑุฉ:
- `static/js/order_form_simplified.js` - ุชุญุณููุงุช ุดุงููุฉ ูููุงุฌูุฉ

#### ๐จ ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ:
- ูุคุดุฑ ุชูุฏู ุจู 4 ุฎุทูุงุช ูุงุถุญุฉ
- ุนุฏุงุฏ ุงูููุช ุงููููุถู
- ุฑุณุงุฆู ุญุงูุฉ ุฏููุงููููุฉ
- ุชุนุทูู ุงูุฃุฒุฑุงุฑ ุฃุซูุงุก ุงููุนุงูุฌุฉ

### 4. ุชุญุณูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ

#### โ ูุง ุชู ุชุทุจููู:
- **ุชุญุณูู ุงูุจุญุซ**: ุฅูุบุงุก ุงูุทูุจุงุช ุงูุณุงุจูุฉ ูุชุญุณูู ุงูุฃุฏุงุก
- **Event Delegation**: ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุญุฏุงุซ
- **RequestAnimationFrame**: ุชุญุณูู ุชุญุฏูุซ ุงููุงุฌูุฉ
- **Debouncing**: ุชูููู ุนุฏุฏ ุงุณุชุฏุนุงุกุงุช ุงูุชุญูู

#### ๐ ุงููููุงุช ุงููุชุฃุซุฑุฉ:
- `static/js/order_form_simplified.js` - ุชุญุณููุงุช ุดุงููุฉ

### 5. ูุธุงู ุงูุชุฎุฒูู ุงููุคูุช

#### โ ูุง ุชู ุชุทุจููู:
- **ุชุฎุฒูู ุฅุนุฏุงุฏุงุช ุงูุชุณููู**: ุชุฎุฒูู ูุคูุช ูุฅุนุฏุงุฏุงุช ุงูุชุณููู
- **ุชุฎุฒูู ุจูุงูุงุช ุงูุนููุงุก**: ุชุฎุฒูู ูุคูุช ูุจูุงูุงุช ุงูุนููุงุก ุงููุชูุฑุฑุฉ
- **ุชุฎุฒูู ูุชุงุฆุฌ ุงูุจุญุซ**: ุชุฎุฒูู ูุคูุช ููุชุงุฆุฌ ุงูุจุญุซ ุนู ุงูููุชุฌุงุช
- **ุฅุดุงุฑุงุช ุงูุชูุธูู**: ุชูุธูู ุชููุงุฆู ุนูุฏ ุชุญุฏูุซ ุงูุจูุงูุงุช

#### ๐ ุงููููุงุช ุงููุชุฃุซุฑุฉ:
- `orders/cache.py` - ูุธุงู ุงูุชุฎุฒูู ุงููุคูุช ุงูุฌุฏูุฏ
- `orders/signals.py` - ุฅุดุงุฑุงุช ุชูุธูู ุงูุชุฎุฒูู ุงููุคูุช
- `inventory/views.py` - ุชุญุฏูุซ API ุงูุจุญุซ
- `orders/management/commands/clear_cache.py` - ุฃูุฑ ุชูุธูู ุงูุชุฎุฒูู ุงููุคูุช

#### ๐ง ููููุฉ ุงูุงุณุชุฎุฏุงู:
```python
# ุงุณุชุฎุฏุงู ุงูุชุฎุฒูู ุงููุคูุช
from orders.cache import get_cached_delivery_settings, search_products_cached

# ุงูุญุตูู ุนูู ุฅุนุฏุงุฏุงุช ุงูุชุณููู
settings = get_cached_delivery_settings()

# ุงูุจุญุซ ุนู ุงูููุชุฌุงุช ูุน ุงูุชุฎุฒูู ุงููุคูุช
products = search_products_cached("ุงุณุชุนูุงู ุงูุจุญุซ")
```

---

## ๐ ุชุญุณููุงุช ุงูุฃุฏุงุก ุงููุชููุนุฉ

### โฑ๏ธ ูุจู ุงูุชุญุณููุงุช:
- **ููุช ุฅูุดุงุก ุงูุทูุจ**: 15-30 ุซุงููุฉ (ูุน ุฑูุน ุงููููุงุช)
- **ููุช ุงูุจุญุซ ุนู ุงูููุชุฌุงุช**: 2-5 ุซูุงูู
- **ุงุณุชููุงู ุงูุฐุงูุฑุฉ**: ูุฑุชูุน ุจุณุจุจ ุงูุงุณุชุนูุงูุงุช ุงููุชูุฑุฑุฉ
- **ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู**: ูุญุจุทุฉ ุจุณุจุจ ุนุฏู ูุถูุญ ุงูุชูุฏู

### โก ุจุนุฏ ุงูุชุญุณููุงุช:
- **ููุช ุฅูุดุงุก ุงูุทูุจ**: 2-5 ุซูุงูู (ุฑูุน ุงููููุงุช ูู ุงูุฎูููุฉ)
- **ููุช ุงูุจุญุซ ุนู ุงูููุชุฌุงุช**: 0.1-0.5 ุซุงููุฉ (ูุน ุงูุชุฎุฒูู ุงููุคูุช)
- **ุงุณุชููุงู ุงูุฐุงูุฑุฉ**: ููุฎูุถ ุจุณุจุจ ุงูุชุฎุฒูู ุงููุคูุช ุงูุฐูู
- **ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู**: ุณูุณุฉ ูุน ูุคุดุฑุงุช ุชูุฏู ูุงุถุญุฉ

### ๐ ูุณุจ ุงูุชุญุณู ุงููุชููุนุฉ:
- **ุณุฑุนุฉ ุฅูุดุงุก ุงูุทูุจุงุช**: ุชุญุณู ุจูุณุจุฉ 80-90%
- **ุณุฑุนุฉ ุงูุจุญุซ**: ุชุญุณู ุจูุณุจุฉ 90-95%
- **ุงุณุชููุงู ุงูููุงุฑุฏ**: ุงูุฎูุงุถ ุจูุณุจุฉ 60-70%
- **ุฑุถุง ุงููุณุชุฎุฏู**: ุชุญุณู ูุจูุฑ ุจุณุจุจ ุงููุถูุญ ูุงูุณุฑุนุฉ

---

## ๐๏ธ ุฅุนุฏุงุฏ ุงููุธุงู

### 1. ุงูุชุดุบูู ุงูุชููุงุฆู (ุงูุทุฑููุฉ ุงูููุตู ุจูุง):
```bash
# ุชุดุบูู ุงููุธุงู ูุงููุงู ูุน Celery ุชููุงุฆูุงู
./ููููุณ/run-production.sh
```

ูุฐุง ุงูุฃูุฑ ุณูููู ุจู:
- โ ูุญุต ูุชุดุบูู Redis ุชููุงุฆูุงู
- โ ุชุดุบูู Celery Worker ุชููุงุฆูุงู
- โ ุชุดุบูู Celery Beat ุชููุงุฆูุงู
- โ ุชุดุบูู ุฎุงุฏู ุงูููุจ
- โ ุชุดุบูู Cloudflare Tunnel
- โ ูุฑุงูุจุฉ ุฌููุน ุงูุนูููุงุช ูุฅุนุงุฏุฉ ุชุดุบูููุง ุนูุฏ ุงูุญุงุฌุฉ

### 2. ุฅููุงู ุงููุธุงู:
```bash
# ุฅููุงู ุฌููุน ุงูุฎุฏูุงุช
./ููููุณ/stop-all.sh
```

### 3. ุงุฎุชุจุงุฑ Celery:
```bash
# ุงุฎุชุจุงุฑ ุดุงูู ูู Celery ูุงูููุงู ุงูุฎูููุฉ
python test_celery.py
```

### 4. ุงูุชุดุบูู ุงููุฏูู (ููุชุทููุฑ):
```bash
# ุชุซุจูุช Redis (ุฅุฐุง ูู ููู ูุซุจุชุงู)
sudo apt-get install redis-server

# ุชุดุบูู Celery Worker ูุฏููุงู
celery -A crm worker --loglevel=info

# ุชุดุบูู Celery Beat ูุฏููุงู (ููููุงู ุงูุฏูุฑูุฉ)
celery -A crm beat --loglevel=info
```

### 2. ุฅุนุฏุงุฏุงุช ุงูุชุฎุฒูู ุงููุคูุช:
```python
# ูู settings.py
CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.redis.RedisCache',
        'LOCATION': 'redis://127.0.0.1:6379/1',
        'OPTIONS': {
            'CLIENT_CLASS': 'django_redis.client.DefaultClient',
        },
        'KEY_PREFIX': 'homeupdate',
        'TIMEOUT': 300,
    }
}
```

### 3. ุฃูุงูุฑ ุงูุตูุงูุฉ:
```bash
# ุชูุธูู ุงูุชุฎุฒูู ุงููุคูุช
python manage.py clear_cache --all

# ุชูุธูู ุจูุงูุงุช ูุญุฏุฏุฉ
python manage.py clear_cache --products
python manage.py clear_cache --customers
python manage.py clear_cache --stats
```

---

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### 1. ูุฑุงูุจุฉ ุดุงููุฉ (ูุฏูุฌุฉ ูู ููู ุงูุชุดุบูู):
```bash
# ูุฑุงูุจุฉ ุฌููุน ุงูุนูููุงุช ูู ุงูููุช ุงููุนูู
./ููููุณ/run-production.sh
# ุณูุนุฑุถ ุญุงูุฉ ุฌููุน ุงูุฎุฏูุงุช ูู 30 ุซุงููุฉ
```

### 2. ูุฑุงูุจุฉ ุงูููุงู ุงูุฎูููุฉ:
```bash
# ุนุฑุถ ุญุงูุฉ ุงูููุงู
celery -A crm inspect active

# ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช
celery -A crm inspect stats

# ูุฑุงูุจุฉ ุงูุณุฌูุงุช
tail -f /tmp/celery_worker.log
tail -f /tmp/celery_beat.log
```

### 3. ูุฑุงูุจุฉ ุงูุชุฎุฒูู ุงููุคูุช:
```bash
# ุงุฎุชุจุงุฑ ุดุงูู ูููุธุงู
python test_celery.py

# ุชูุธูู ุงูุชุฎุฒูู ุงููุคูุช
python manage.py clear_cache --all
```

### 4. ูุฑุงูุจุฉ Redis:
```bash
# ูุนูููุงุช Redis
redis-cli info

# ูุฑุงูุจุฉ ุงูุฃูุงูุฑ
redis-cli monitor
```

### 3. ูุฑุงูุจุฉ ุงูุฃุฏุงุก:
- ุชู ุฅุถุงูุฉ middleware ูููุงุณ ุฃููุงุช ุงูุงุณุชุฌุงุจุฉ
- ุชุณุฌูู ุงูุทูุจุงุช ุงูุจุทูุฆุฉ ูู ุงูุณุฌูุงุช
- ุฅุถุงูุฉ headers ููุนูููุงุช ุงูุฃุฏุงุก

---

## ๐จ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู ุดุงุฆุนุฉ ูุญููููุง:

#### 1. ูุดู ูู ุชุดุบูู ุงููุธุงู:
```bash
# ุงุฎุชุจุงุฑ ุดุงูู ูููุธุงู
python test_celery.py

# ุฅููุงู ุฌููุน ุงูุนูููุงุช ูุฅุนุงุฏุฉ ุงูุชุดุบูู
./ููููุณ/stop-all.sh
./ููููุณ/run-production.sh
```

#### 2. ูุดู ุฑูุน ุงููููุงุช:
```bash
# ุงูุชุญูู ูู ุญุงูุฉ ุงูููุงู
celery -A crm inspect active

# ูุฑุงูุจุฉ ุณุฌูุงุช Celery
tail -f /tmp/celery_worker.log

# ุฅุนุงุฏุฉ ุชุดุบูู ุงูุนุงูู
./ููููุณ/stop-all.sh
./ููููุณ/run-production.sh
```

#### 3. ูุดุงูู ุงูุชุฎุฒูู ุงููุคูุช:
```bash
# ุชูุธูู ุงูุชุฎุฒูู ุงููุคูุช
python manage.py clear_cache --all

# ุงุฎุชุจุงุฑ Redis
redis-cli ping

# ุฅุนุงุฏุฉ ุชุดุบูู Redis
sudo systemctl restart redis-server
```

#### 4. ุจุทุก ูู ุงูุฃุฏุงุก:
```bash
# ูุญุต ุงูุณุฌูุงุช
tail -f logs/django.log
tail -f /tmp/celery_worker.log

# ูุฑุงูุจุฉ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ
htop

# ูุญุต ุญุงูุฉ Redis
redis-cli info memory
```

#### 5. ูุดุงูู ุงูุดุจูุฉ:
```bash
# ูุญุต ุงุชุตุงู Cloudflare Tunnel
./cloudflared tunnel info

# ุฅุนุงุฏุฉ ุชุดุบูู ุงููุธุงู ูุงููุงู
./ููููุณ/stop-all.sh
sleep 5
./ููููุณ/run-production.sh
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

### โ๏ธ ุชุญุฐูุฑุงุช:
1. **ุชุฃูุฏ ูู ุชุดุบูู Redis** ูุจู ุงุณุชุฎุฏุงู ุงูุชุฎุฒูู ุงููุคูุช
2. **ุชุฃูุฏ ูู ุชุดุบูู Celery** ูุจู ุฅูุดุงุก ุงูุทูุจุงุช ูุน ุงููููุงุช
3. **ุฑุงูุจ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ** ุนูุฏ ุงุณุชุฎุฏุงู ุงูุชุฎุฒูู ุงููุคูุช ุจูุซุงูุฉ

### ๐ก ูุตุงุฆุญ ููุตูุงูุฉ:
1. **ูุธู ุงูุชุฎุฒูู ุงููุคูุช ุฏูุฑูุงู** ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ ุงููุฎุตุต
2. **ุฑุงูุจ ุฃุฏุงุก ุงูููุงู ุงูุฎูููุฉ** ุจุงุณุชุฎุฏุงู Celery monitoring
3. **ุงุญุชูุธ ุจูุณุฎ ุงุญุชูุงุทูุฉ** ูู ุฅุนุฏุงุฏุงุช Redis

### ๐ ุชุญุฏูุซุงุช ูุณุชูุจููุฉ:
1. ุฅุถุงูุฉ ูุฑุงูุจุฉ ุฃุฏุงุก ูุชูุฏูุฉ
2. ุชุญุณูู ุฎูุงุฑุฒููุงุช ุงูุชุฎุฒูู ุงููุคูุช
3. ุฅุถุงูุฉ ุฅุญุตุงุฆูุงุช ููุตูุฉ ููุฃุฏุงุก
4. ุชุญุณูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุฃูุซุฑ

---

## ๐ ุงูุฏุนู

ูู ุญุงูุฉ ูุฌูุฏ ูุดุงูู ุฃู ุฃุณุฆูุฉ ุญูู ุงูุชุญุณููุงุช:
1. ุชุญูู ูู ุงูุณุฌูุงุช ูู `logs/django.log`
2. ุงุณุชุฎุฏู ุฃูุงูุฑ ุงูุตูุงูุฉ ุงููุชููุฑุฉ
3. ุฑุงุฌุน ูุฐุง ุงูุฏููู ููุญููู ุงูุดุงุฆุนุฉ

---

## โก ุงูุฃูุงูุฑ ุงูุณุฑูุนุฉ

### ๐ ุงูุชุดุบูู ูุงูุฅููุงู:
```bash
# ุชุดุบูู ุงููุธุงู ูุงููุงู
./ููููุณ/run-production.sh

# ุฅููุงู ุงููุธุงู ูุงููุงู
./ููููุณ/stop-all.sh

# ุงุฎุชุจุงุฑ ุงููุธุงู
python test_celery.py
```

### ๐งน ุงูุตูุงูุฉ:
```bash
# ุชูุธูู ุงูุชุฎุฒูู ุงููุคูุช
python manage.py clear_cache --all

# ุชูุธูู ูููุงุช ุงูุณุฌูุงุช
find /tmp -name "*.log" -mtime +7 -delete

# ุฅุนุงุฏุฉ ุชุดุบูู Redis
sudo systemctl restart redis-server
```

### ๐ ุงููุฑุงูุจุฉ:
```bash
# ูุฑุงูุจุฉ Celery
celery -A crm inspect active
celery -A crm inspect stats

# ูุฑุงูุจุฉ ุงูุณุฌูุงุช
tail -f /tmp/celery_worker.log
tail -f /tmp/celery_beat.log

# ูุฑุงูุจุฉ Redis
redis-cli info
redis-cli monitor
```

### ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก:
```bash
# ุฅุนุงุฏุฉ ุชุดุบูู ูุงููุฉ
./ููููุณ/stop-all.sh && sleep 5 && ./ููููุณ/run-production.sh

# ูุญุต ุงูุนูููุงุช
ps aux | grep -E "(celery|gunicorn|redis)"

# ูุญุต ุงูููุงูุฐ
netstat -tlnp | grep -E "(8000|6379)"
```

---

**ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ**: 2025-01-16
