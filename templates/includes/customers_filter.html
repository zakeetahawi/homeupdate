{% extends 'includes/compact_filter.html' %}
{% block additional_filters %}
    <div class="cf-field">
        <label class="cf-label">التصنيف</label>
        <select name="category" class="cf-select">
            <option value="">الكل</option>
            {% for category in categories %}
                <option value="{{ category.id }}"
                        {% if form.category.value == category.id|stringformat:'s' %}selected{% endif %}>
                    {{ category.name }}
                </option>
            {% endfor %}
        </select>
    </div>
    <div class="cf-field">
        <label class="cf-label">الفرع</label>
        <select name="branch" class="cf-select">
            <option value="">الكل</option>
            {% for branch in branches %}
                <option value="{{ branch.id }}"
                        {% if form.branch.value == branch.id|stringformat:'s' %}selected{% endif %}>
                    {{ branch.name }}
                </option>
            {% endfor %}
        </select>
    </div>
    <div class="cf-field">
        <label class="cf-label">نوع العميل</label>
        <select name="customer_type" class="cf-select">
            <option value="">الكل</option>
            {% for value, label in form.customer_type.field.choices %}
                {% if value %}
                    <option value="{{ value }}"
                            {% if form.customer_type.value == value %}selected{% endif %}>{{ label }}</option>
                {% endif %}
            {% endfor %}
        </select>
    </div>
    <div class="cf-field">
        <label class="cf-label">الحالة</label>
        <select name="status" class="cf-select">
            <option value="">الكل</option>
            <option value="active"
                    {% if form.status.value == 'active' %}selected{% endif %}>نشط</option>
            <option value="inactive"
                    {% if form.status.value == 'inactive' %}selected{% endif %}>غير نشط</option>
        </select>
    </div>
    <div class="cf-field">
        <label class="cf-label">من تاريخ</label>
        <input type="date" name="date_from" class="cf-input" value="{{ form.date_from.value|default:'' }}">
    </div>
    <div class="cf-field">
        <label class="cf-label">إلى تاريخ</label>
        <input type="date" name="date_to" class="cf-input" value="{{ form.date_to.value|default:'' }}">
    </div>
{% endblock %}
{% block active_filter_tags %}
    {% if form.category.value %}
        {% for category in categories %}
            {% if category.id|stringformat:'s' == form.category.value %}
                <span class="cf-chip cf-chip-type">
                    <i class="fas fa-folder me-1"></i>{{ category.name }}
                    <button type="button" onclick="removeFilter('category')" class="cf-chip-x">&times;</button>
                </span>
            {% endif %}
        {% endfor %}
    {% endif %}
    {% if form.branch.value %}
        {% for branch in branches %}
            {% if branch.id|stringformat:'s' == form.branch.value %}
                <span class="cf-chip cf-chip-branch">
                    <i class="fas fa-code-branch me-1"></i>{{ branch.name }}
                    <button type="button" onclick="removeFilter('branch')" class="cf-chip-x">&times;</button>
                </span>
            {% endif %}
        {% endfor %}
    {% endif %}
    {% if form.customer_type.value %}
        <span class="cf-chip cf-chip-type">
            <i class="fas fa-tag me-1"></i>
            {% for value, label in form.customer_type.field.choices %}
                {% if value == form.customer_type.value %}{{ label }}{% endif %}
            {% endfor %}
            <button type="button" onclick="removeFilter('customer_type')" class="cf-chip-x">&times;</button>
        </span>
    {% endif %}
    {% if form.status.value %}
        <span class="cf-chip cf-chip-status">
            <i class="fas fa-circle me-1" style="font-size:0.45rem"></i>
            {% if form.status.value == 'active' %}نشط{% else %}غير نشط{% endif %}
            <button type="button" onclick="removeFilter('status')" class="cf-chip-x">&times;</button>
        </span>
    {% endif %}
    {% if form.date_from.value %}
        <span class="cf-chip cf-chip-date">
            <i class="fas fa-calendar me-1"></i>من: {{ form.date_from.value }}
            <button type="button" onclick="removeFilter('date_from')" class="cf-chip-x">&times;</button>
        </span>
    {% endif %}
    {% if form.date_to.value %}
        <span class="cf-chip cf-chip-date">
            <i class="fas fa-calendar me-1"></i>إلى: {{ form.date_to.value }}
            <button type="button" onclick="removeFilter('date_to')" class="cf-chip-x">&times;</button>
        </span>
    {% endif %}
{% endblock %}
