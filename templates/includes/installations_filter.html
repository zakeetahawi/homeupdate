{% extends 'includes/compact_filter.html' %}
{% block additional_filters %}
    <div class="cf-field">
        <label class="cf-label">الحالة</label>
        <select name="status" class="cf-select">
            <option value="">الكل</option>
            <option value="needs_scheduling"
                    {% if status_filter == 'needs_scheduling' %}selected{% endif %}>يحتاج جدولة</option>
            <option value="scheduled"
                    {% if status_filter == 'scheduled' %}selected{% endif %}>مجدول</option>
            <option value="in_installation"
                    {% if status_filter == 'in_installation' %}selected{% endif %}>قيد التركيب</option>
            <option value="completed"
                    {% if status_filter == 'completed' %}selected{% endif %}>مكتمل</option>
            <option value="cancelled"
                    {% if status_filter == 'cancelled' %}selected{% endif %}>ملغي</option>
            <option value="modification_required"
                    {% if status_filter == 'modification_required' %}selected{% endif %}>يحتاج تعديل</option>
            <option value="modification_in_progress"
                    {% if status_filter == 'modification_in_progress' %}selected{% endif %}>قيد التعديل</option>
            <option value="modification_completed"
                    {% if status_filter == 'modification_completed' %}selected{% endif %}>تم التعديل</option>
        </select>
    </div>
    <div class="cf-field">
        <label class="cf-label">الفرع</label>
        <select name="branch" class="cf-select">
            <option value="">الكل</option>
            {% for branch in branches %}
                <option value="{{ branch.id }}"
                        {% if branch_filter == branch.id|stringformat:'s' %}selected{% endif %}>
                    {{ branch.name }}
                </option>
            {% endfor %}
        </select>
    </div>
    <div class="cf-field">
        <label class="cf-label">الفريق</label>
        <select name="team" class="cf-select">
            <option value="">الكل</option>
            {% for team in teams %}
                <option value="{{ team.id }}"
                        {% if team_filter == team.id|stringformat:'s' %}selected{% endif %}>{{ team.name }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="cf-field">
        <label class="cf-label">من تاريخ</label>
        <input type="date" name="date_from" class="cf-input" value="{{ date_from }}">
    </div>
    <div class="cf-field">
        <label class="cf-label">إلى تاريخ</label>
        <input type="date" name="date_to" class="cf-input" value="{{ date_to }}">
    </div>
{% endblock %}
{% block active_filter_tags %}
    {% if status_filter %}
        <span class="cf-chip cf-chip-status">
            <i class="fas fa-circle me-1" style="font-size:0.45rem"></i>
            {% if status_filter == 'needs_scheduling' %}يحتاج جدولة
            {% elif status_filter == 'scheduled' %}مجدول
            {% elif status_filter == 'in_installation' %}قيد التركيب
            {% elif status_filter == 'completed' %}مكتمل
            {% elif status_filter == 'cancelled' %}ملغي
            {% elif status_filter == 'modification_required' %}يحتاج تعديل
            {% elif status_filter == 'modification_in_progress' %}قيد التعديل
            {% elif status_filter == 'modification_completed' %}تم التعديل
            {% else %}{{ status_filter }}{% endif %}
            <button type="button" onclick="removeFilter('status')" class="cf-chip-x">&times;</button>
        </span>
    {% endif %}
    {% if team_filter %}
        {% for team in teams %}
            {% if team.id|stringformat:'s' == team_filter %}
                <span class="cf-chip cf-chip-person">
                    <i class="fas fa-users me-1"></i>{{ team.name }}
                    <button type="button" onclick="removeFilter('team')" class="cf-chip-x">&times;</button>
                </span>
            {% endif %}
        {% endfor %}
    {% endif %}
    {% if area_filter %}
        {% for area in areas %}
            {% if area.id|stringformat:'s' == area_filter %}
                <span class="cf-chip cf-chip-branch">
                    <i class="fas fa-map-marker-alt me-1"></i>{{ area.name }}
                    <button type="button" onclick="removeFilter('area')" class="cf-chip-x">&times;</button>
                </span>
            {% endif %}
        {% endfor %}
    {% endif %}
    {% if date_from %}
        <span class="cf-chip cf-chip-date">
            <i class="fas fa-calendar me-1"></i>من: {{ date_from }}
            <button type="button" onclick="removeFilter('date_from')" class="cf-chip-x">&times;</button>
        </span>
    {% endif %}
    {% if date_to %}
        <span class="cf-chip cf-chip-date">
            <i class="fas fa-calendar me-1"></i>إلى: {{ date_to }}
            <button type="button" onclick="removeFilter('date_to')" class="cf-chip-x">&times;</button>
        </span>
    {% endif %}
{% endblock %}
