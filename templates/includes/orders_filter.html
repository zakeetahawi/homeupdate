{% extends 'includes/compact_filter.html' %}
{% block additional_filters %}
    {% if show_branch_filter %}
        <div class="filter-group">
            <label class="filter-label">الفرع</label>
            <select name="branch" class="filter-select">
                <option value="">كل الفروع</option>
                {% for branch in branches %}
                    <option value="{{ branch.id }}"
                            {% if branch_filter == branch.id|stringformat:'s' %}selected{% endif %}>
                        {{ branch.name }}
                    </option>
                {% endfor %}
            </select>
        </div>
    {% endif %}
    <div class="filter-group">
        <label class="filter-label">البائع</label>
        <select name="salesperson" class="filter-select">
            <option value="">جميع البائعين</option>
            {% for salesperson in salespersons %}
                <option value="{{ salesperson.id }}"
                        {% if salesperson_filter == salesperson.id|stringformat:'s' %}selected{% endif %}>
                    {{ salesperson.name }}
                </option>
            {% endfor %}
        </select>
    </div>
    <div class="filter-group">
        <label class="filter-label">نوع الطلب</label>
        <select name="order_type" class="filter-select">
            <option value="">كل الأنواع</option>
            <option value="installation"
                    {% if order_type_filter == 'installation' %}selected{% endif %}>تركيب</option>
            <option value="accessory"
                    {% if order_type_filter == 'accessory' %}selected{% endif %}>إكسسوار</option>
            <option value="tailoring"
                    {% if order_type_filter == 'tailoring' %}selected{% endif %}>تسليم</option>
            <option value="inspection"
                    {% if order_type_filter == 'inspection' %}selected{% endif %}>معاينة</option>
            <option value="products"
                    {% if order_type_filter == 'products' %}selected{% endif %}>منتجات</option>
        </select>
    </div>
    <div class="filter-group">
        <label class="filter-label">حالة الطلب</label>
        <select name="order_status" class="filter-select">
            <option value="">كل الحالات</option>
            <option value="pending_approval"
                    {% if status_filter == 'pending_approval' %}selected{% endif %}>قيد الموافقة</option>
            <option value="pending"
                    {% if status_filter == 'pending' %}selected{% endif %}>قيد الانتظار</option>
            <option value="in_progress"
                    {% if status_filter == 'in_progress' %}selected{% endif %}>قيد التصنيع</option>
            <option value="ready_install"
                    {% if status_filter == 'ready_install' %}selected{% endif %}>جاهز للتركيب</option>
            <option value="completed"
                    {% if status_filter == 'completed' %}selected{% endif %}>مكتمل</option>
            <option value="delivered"
                    {% if status_filter == 'delivered' %}selected{% endif %}>تم التسليم</option>
            <option value="rejected"
                    {% if status_filter == 'rejected' %}selected{% endif %}>مرفوض</option>
            <option value="cancelled"
                    {% if status_filter == 'cancelled' %}selected{% endif %}>ملغي</option>
            <option value="manufacturing_deleted"
                    {% if status_filter == 'manufacturing_deleted' %}selected{% endif %}>أمر تصنيع محذوف</option>
        </select>
    </div>
    <div class="filter-group">
        <label class="filter-label">وضع العميل</label>
        <select name="status" class="filter-select">
            <option value="">كل العملاء</option>
            <option value="vip" {% if status_param == 'vip' %}selected{% endif %}>VIP</option>
            <option value="normal" {% if status_param == 'normal' %}selected{% endif %}>عادي</option>
        </select>
    </div>
    <div class="filter-group">
        <label class="filter-label">من تاريخ</label>
        <input type="date"
               name="date_from"
               class="filter-input"
               value="{{ date_from }}">
    </div>
    <div class="filter-group">
        <label class="filter-label">إلى تاريخ</label>
        <input type="date" name="date_to" class="filter-input" value="{{ date_to }}">
    </div>
{% endblock %}
{% block active_filter_tags %}
    {% if branch_filter %}
        {% for branch in branches %}
            {% if branch.id|stringformat:'s' == branch_filter %}
                <span class="filter-tag">
                    فرع: {{ branch.name }}
                    <button type="button" onclick="removeFilter('branch')" class="remove-filter">×</button>
                </span>
            {% endif %}
        {% endfor %}
    {% endif %}
    {% if salesperson_filter %}
        {% for salesperson in salespersons %}
            {% if salesperson.id|stringformat:'s' == salesperson_filter %}
                <span class="filter-tag">
                    بائع: {{ salesperson.name }}
                    <button type="button"
                            onclick="removeFilter('salesperson')"
                            class="remove-filter">×</button>
                </span>
            {% endif %}
        {% endfor %}
    {% endif %}
    {% if order_type_filter %}
        <span class="filter-tag">
            نوع:
            {% if order_type_filter == 'installation' %}
                تركيب
            {% elif order_type_filter == 'accessory' %}
                إكسسوار
            {% elif order_type_filter == 'tailoring' %}
                تسليم
            {% elif order_type_filter == 'inspection' %}
                معاينة
            {% elif order_type_filter == 'products' %}
                منتجات
            {% else %}
                {{ order_type_filter }}
            {% endif %}
            <button type="button"
                    onclick="removeFilter('order_type')"
                    class="remove-filter">×</button>
        </span>
    {% endif %}
    {% if status_filter %}
        <span class="filter-tag">
            حالة:
            {% if status_filter == 'pending_approval' %}
                قيد الموافقة
            {% elif status_filter == 'pending' %}
                قيد الانتظار
            {% elif status_filter == 'in_progress' %}
                قيد التنفيذ
            {% elif status_filter == 'ready_install' %}
                جاهز للتركيب
            {% elif status_filter == 'completed' %}
                مكتمل
            {% elif status_filter == 'delivered' %}
                تم التسليم
            {% elif status_filter == 'rejected' %}
                مرفوض
            {% elif status_filter == 'cancelled' %}
                ملغي
            {% else %}
                {{ status_filter }}
            {% endif %}
            <button type="button"
                    onclick="removeFilter('order_status')"
                    class="remove-filter">×</button>
        </span>
    {% endif %}
    {% if status_param %}
        <span class="filter-tag">
            وضع العميل:
            {% if status_param == 'vip' %}
                VIP
            {% else %}
                عادي
            {% endif %}
            <button type="button" onclick="removeFilter('status')" class="remove-filter">×</button>
        </span>
    {% endif %}
    {% if date_from %}
        <span class="filter-tag">
            من: {{ date_from }}
            <button type="button"
                    onclick="removeFilter('date_from')"
                    class="remove-filter">×</button>
        </span>
    {% endif %}
    {% if date_to %}
        <span class="filter-tag">
            إلى: {{ date_to }}
            <button type="button" onclick="removeFilter('date_to')" class="remove-filter">×</button>
        </span>
    {% endif %}
{% endblock %}
