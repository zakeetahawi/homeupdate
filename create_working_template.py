#!/usr/bin/env python3
"""
ุณูุฑูุจุช ุฅูุดุงุก ูุงูุจ ุจุณูุท ูุนูู ุจุดูู ุตุญูุญ
"""

import pandas as pd
import os

def create_working_template():
    """ุฅูุดุงุก ูุงูุจ ุจุณูุท ูุนูู ุจุดูู ุตุญูุญ"""
    print("๐ง ุฅูุดุงุก ูุงูุจ ุจุณูุท ูุนูู...")
    
    try:
        # ุฅูุดุงุก ุจูุงูุงุช ุงููุงูุจ ููููุชุฌุงุช
        products_data = {
            'ุงุณู ุงูููุชุฌ': ['ูุงุจุชูุจ HP', 'ุทุงุจุนุฉ Canon', 'ูุงูุณ ูุงุณููู', 'ุดุงุดุฉ LED'],
            'ุงูููุฏ': ['LAP001', 'PRN001', 'MOU001', 'MON001'],
            'ุงููุฆุฉ': ['ุฃุฌูุฒุฉ ููุจููุชุฑ', 'ุทุงุจุนุงุช', 'ููุญูุงุช', 'ุดุงุดุงุช'],
            'ุงูุณุนุฑ': [15000, 2500, 150, 800],
            'ุงููููุฉ': [10, 5, 20, 8],
            'ุงููุตู': ['ูุงุจุชูุจ HP ุจุฑูุณูุณูุฑ i5', 'ุทุงุจุนุฉ ููุฒุฑ ููููุฉ', 'ูุงูุณ ูุงุณููู ุนุงูู ุงูุฌูุฏุฉ', 'ุดุงุดุฉ LED 24 ุจูุตุฉ'],
            'ุงูุญุฏ ุงูุฃุฏูู': [5, 2, 10, 3],
            'ุงูุนููุฉ': ['EGP', 'EGP', 'EGP', 'EGP'],
            'ุงููุญุฏุฉ': ['ูุทุนุฉ', 'ูุทุนุฉ', 'ูุทุนุฉ', 'ูุทุนุฉ']
        }
        
        # ุฅูุดุงุก DataFrame ููููุชุฌุงุช
        df_products = pd.DataFrame(products_data)
        
        # ุฅูุดุงุก ุจูุงูุงุช ุชุญุฏูุซ ุงููุฎุฒูู
        stock_data = {
            'ููุฏ ุงูููุชุฌ': ['LAP001', 'PRN001', 'MOU001'],
            'ุงููููุฉ': [25, 15, 30],
            'ููุงุญุธุงุช': ['ุชุญุฏูุซ ุจุนุฏ ุงูุฌุฑุฏ', 'ุฅุถุงูุฉ ูุฎุฒูู ุฌุฏูุฏ', 'ุชุญุฏูุซ ุงููููุฉ']
        }
        
        df_stock = pd.DataFrame(stock_data)
        
        # ุญูุธ ูููู ุฅูุณู ุจุณูุท
        file_path = 'working_template.xlsx'
        
        with pd.ExcelWriter(file_path, engine='openpyxl') as writer:
            df_products.to_excel(writer, sheet_name='ุงูููุชุฌุงุช', index=False)
            df_stock.to_excel(writer, sheet_name='ุชุญุฏูุซ ุงููุฎุฒูู', index=False)
        
        print(f"โ ุชู ุฅูุดุงุก ุงููุงูุจ ุงูุจุณูุท: {file_path}")
        print(f"๐ ุนุฏุฏ ุงูููุชุฌุงุช: {len(df_products)}")
        print(f"๐ ุนุฏุฏ ุชุญุฏูุซุงุช ุงููุฎุฒูู: {len(df_stock)}")
        
        return file_path
        
    except Exception as e:
        print(f"โ ุฎุทุฃ ูู ุฅูุดุงุก ุงููุงูุจ: {str(e)}")
        return None

def test_template():
    """ุงุฎุชุจุงุฑ ุงููุงูุจ"""
    print("๐งช ุงุฎุชุจุงุฑ ุงููุงูุจ...")
    
    file_path = create_working_template()
    if not file_path:
        return False
    
    try:
        # ุงุฎุชุจุงุฑ ูุฑุงุกุฉ ุงูููู
        df_products = pd.read_excel(file_path, sheet_name='ุงูููุชุฌุงุช')
        df_stock = pd.read_excel(file_path, sheet_name='ุชุญุฏูุซ ุงููุฎุฒูู')
        
        print("โ ุชู ูุฑุงุกุฉ ุงููุงูุจ ุจูุฌุงุญ")
        print(f"๐ ุงูููุชุฌุงุช: {len(df_products)} ุตู")
        print(f"๐ ุงููุฎุฒูู: {len(df_stock)} ุตู")
        
        print("\n๐ ุจูุงูุงุช ุงูููุชุฌุงุช:")
        print(df_products)
        
        print("\n๐ ุจูุงูุงุช ุงููุฎุฒูู:")
        print(df_stock)
        
        return True
        
    except Exception as e:
        print(f"โ ุฎุทุฃ ูู ุงุฎุชุจุงุฑ ุงููุงูุจ: {str(e)}")
        return False

def main():
    """ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ"""
    print("๐ ุจุฏุก ุฅูุดุงุก ูุงูุจ ุจุณูุท ูุนูู...")
    print("=" * 50)
    
    if test_template():
        print("โ ุงููุงูุจ ุฌุงูุฒ ููุงุณุชุฎุฏุงู")
        print("\n๐ ุงูุชุนูููุงุช:")
        print("1. ุงุณุชุฎุฏู ููู working_template.xlsx")
        print("2. ุงููุฃ ุงูุจูุงูุงุช ุงููุทููุจุฉ")
        print("3. ุงุญูุธ ุงูููู")
        print("4. ุงุฑูุนู ูู ุงููุธุงู")
    else:
        print("โ ูุดู ูู ุฅูุดุงุก ุงููุงูุจ")
    
    print("=" * 50)
    print("๐ ุงูุชูู ุฅูุดุงุก ุงููุงูุจ")

if __name__ == "__main__":
    main() 