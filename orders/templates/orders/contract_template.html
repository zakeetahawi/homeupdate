<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÿπŸÇÿØ ÿ±ŸÇŸÖ {{ order.order_number }}-{{ order.contract_number|default:"c1" }}</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        @page {
            size: A4 portrait;
            margin: 0.5cm;
        }
        
        @page {
            @bottom-center {
                content: "ÿµŸÅÿ≠ÿ© " counter(page) " ŸÖŸÜ " counter(pages);
                font-size: 10px;
                color: #666;
            }
        }
        
        body {
            font-family: 'Cairo', 'Arial', sans-serif;
            font-size: 11px;
            line-height: 1.2;
            color: #000;
            background: white;
            direction: rtl;
            position: relative;
        }
        
        /* ÿßŸÑÿπŸÑÿßŸÖÿ© ÿßŸÑŸÖÿßÿ¶Ÿäÿ© */
        .watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 14.3cm;
            height: auto;
            opacity: 0.2;
            z-index: 999;
            pointer-events: none;
        }
        
        .watermark img {
            width: 100%;
            height: auto;
            object-fit: contain;
        }
        
        .contract-page {
            max-width: 100%;
            margin: 0 auto;
            background: transparent;
            padding: 2px;
            position: relative;
            z-index: 1;
        }
        
        /* === HEADER === */
        .header-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0;
            border-bottom: 2px solid #a67c52;
            margin-bottom: 2px;
            position: relative;
        }
        
        .header-right {
            flex: 1;
            display: flex;
            gap: 6px;
            align-items: center;
        }
        
        .header-center {
            flex: 1;
            text-align: center;
        }
        
        .header-left {
            flex: 1;
            text-align: left;
        }
        
        .contract-number-main {
            font-size: 14px;
            font-weight: 700;
            color: #a67c52;
            direction: ltr;
            letter-spacing: 1px;
            display: inline-block;
        }
        
        .service-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 700;
            color: white;
            margin-left: 4px;
        }
        
        .badge-tailoring { background: #16a085; }
        .badge-installation { background: #2980b9; }
        .badge-accessory { background: #d35400; }
        .badge-delivery { background: #8e44ad; }
        .badge-products { background: #27ae60; }
        .badge-inspection { background: #e74c3c; }
        
        .order-status-text {
            font-size: 14px;
            font-weight: 700;
            color: #666;
        }
        
        .vip-badge {
            display: inline-flex;
            align-items: center;
            gap: 3px;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 700;
            color: white;
            background: linear-gradient(135deg, #d4af37 0%, #f4e5a1 50%, #d4af37 100%);
            border: 2px solid #f4e5a1;
        }
        
        .vip-crown {
            font-size: 16px;
        }
        
        .logo-box {
            position: absolute;
            left: 0;
            top: 0;
            width: 50px;
            height: 50px;
            border: 2px solid #a67c52;
            border-radius: 5px;
            overflow: hidden;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logo-box img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .cards-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2px;
            margin-bottom: 2px;
            width: 100%;
        }
        
        .info-card {
            background: #f8f5f0;
            border: 1.5px solid #a67c52;
            border-radius: 4px;
            padding: 1px 2px;
            width: 100%;
            box-sizing: border-box;
        }
        
        .card-title {
            font-size: 13px;
            font-weight: 700;
            color: #a67c52;
            margin-bottom: 0;
            border-bottom: 1px solid #d4a574;
            padding-bottom: 0;
        }
        
        .card-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0;
        }
        
        .card-row:last-child {
            margin-bottom: 0;
        }
        
        .card-label {
            font-size: 13px;
            color: #888;
            font-weight: 600;
            display: block;
            margin-bottom: 0px;
        }
        
        .card-value {
            font-size: 13px;
            color: #000;
            font-weight: 700;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .curtain-count-badge {
            background: #a67c52;
            color: white;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 700;
            display: inline-block;
        }
        
        .salesperson-phone {
            font-size: 11px;
            color: #666;
            font-weight: 400;
            display: block;
            margin-top: 0px;
        }
        
        
        /* === CURTAINS SECTION === */
        .section-title {
            font-size: 13px;
            font-weight: 700;
            color: #000;
            margin: 2px 0 1px 0;
            padding-right: 5px;
            border-right: 3px solid #a67c52;
        }
        
        .curtain-row {
            background: white;
            border: 2px solid #a67c52;
            border-radius: 4px;
            padding: 1px;
            margin-bottom: 2px;
            page-break-inside: avoid;
            width: 100%;
            box-sizing: border-box;
        }
        
        /* Curtain Header */
        .curtain-header {
            background: white;
            border: 2px solid #a67c52;
            border-radius: 3px;
            padding: 1px 3px;
            margin-bottom: 1px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 3px;
            width: 100%;
            box-sizing: border-box;
        }
        
        .curtain-name-box {
            display: flex;
            align-items: center;
            gap: 1px;
            flex-wrap: nowrap;
            justify-content: flex-start;
            flex: 0 0 auto;
            min-width: 0;
        }
        
        .curtain-number {
            font-size: 13px;
            font-weight: 700;
            color: #a67c52;
            white-space: nowrap;
            display: inline;
            margin-left: 10px;
        }
        
        .curtain-name {
            font-size: 13px;
            font-weight: 700;
            color: #000;
            white-space: nowrap;
            display: inline;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 130px;
        }
        
        .curtain-dimensions {
            display: flex;
            gap: 20px;
            align-items: center;
            justify-content: center;
            direction: rtl;
            flex: 1;
            min-width: 0;
        }
        
        .dim-item {
            display: flex;
            align-items: center;
            gap: 10px;
            direction: rtl;
        }
        
        .dim-label {
            font-size: 13px;
            color: #000;
            font-weight: 600;
            white-space: nowrap;
            flex-shrink: 0;
            margin-left: 10px;
        }
        
        .dim-badge {
            color: #8b6f47;
            font-size: 14px;
            font-weight: 900;
            white-space: nowrap;
            flex-shrink: 0;
            direction: ltr;
            display: inline-block;
            margin-left: 40px;
        }
        
        .dim-badge.height-badge {
            color: #8b6f47;
        }
        
        .curtain-extra-info {
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: flex-end;
            flex: 0 0 auto;
            min-width: 0;
        }
        
        .curtain-type {
            font-size: 11px;
            color: #666;
            background: #f0f0f0;
            padding: 2px 8px;
            border-radius: 4px;
            white-space: nowrap;
        }
        
        .box-dimensions {
            background: transparent;
            border: 1px solid #d4a574;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            color: #8b6f47;
            white-space: nowrap;
        }
        
        /* Curtain Content Grid */
        .curtain-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1px;
            width: 100%;
            box-sizing: border-box;
        }
        
        /* Fabric Section */
        .fabric-section {
            background: #fafafa;
            padding: 2px 3px;
            border-radius: 4px;
            border: 1.5px solid #a67c52;
            width: 100%;
            box-sizing: border-box;
        }
        
        .section-header {
            font-size: 11px;
            font-weight: 700;
            color: #a67c52;
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: 1px solid #d4a574;
            display: flex;
            align-items: center;
            gap: 2px;
        }
        
        .section-icon {
            font-size: 12px;
        }
        
        .fabric-block {
            background: white;
            padding: 1px 2px;
            border-radius: 3px;
            margin-bottom: 1px;
            border: 1px solid #d4a574;
        }
        
        .fabric-name-line {
            display: flex;
            align-items: center;
            margin-bottom: 1px;
            gap: 4px;
            flex-wrap: nowrap;
            width: 100%;
        }
        
        .fabric-name-bold {
            font-size: 12px;
            font-weight: 700;
            color: #000;
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            min-width: 0;
            margin-left: 6px;
        }
        
        .fabric-type-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 700;
            color: white;
            white-space: nowrap;
            flex: 0 0 auto;
            margin-left: 18px;
        }
        
        .fabric-type-badge.light {
            background: linear-gradient(135deg, #f1c40f 0%, #f9e79f 100%);
            color: #333;
        }
        
        .fabric-type-badge.heavy {
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
        }
        
        .fabric-type-badge.blackout {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        }
        
        .fabric-type-badge.extra {
            background: linear-gradient(135deg, #95a5a6 0%, #bdc3c7 100%);
            color: #333;
        }
        
        .fabric-meters {
            font-size: 12px;
            font-weight: 700;
            color: #2980b9;
            white-space: nowrap;
            flex: 0 0 auto;
        }
        
        .fabric-specs {
            display: flex;
            gap: 2px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .fabric-spec-item {
            background: #f8f5f0;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 11px;
            border: 1px solid #d4a574;
        }
        
        .fabric-spec-item.large {
            font-size: 12px;
            font-weight: 700;
            padding: 3px 6px;
        }
        
        .spec-label-text {
            font-weight: 700;
            color: #a67c52;
        }
        
        .fabric-notes {
            margin-top: 1px;
            font-size: 11px;
            color: #666;
            background: #fffbf0;
            padding: 1px 3px;
            border-radius: 3px;
            border-right: 2px solid #f39c12;
        }
        
        /* Accessories Section */
        .accessories-section {
            background: #fafafa;
            padding: 2px 3px;
            border-radius: 4px;
            border: 1.5px solid #d35400;
            width: 100%;
            box-sizing: border-box;
        }
        
        .acc-title-text {
            font-size: 11px;
            font-weight: 700;
            color: #d35400;
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: 1px solid #f0a373;
            display: flex;
            align-items: center;
            gap: 2px;
        }
        
        .acc-icon-emoji {
            font-size: 12px;
        }
        
        .accessories-items {
            display: flex;
            flex-direction: column;
            gap: 1px;
        }
        
        .accessory-row {
            background: white;
            padding: 2px 3px;
            border-radius: 3px;
            border: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .acc-name-text {
            font-weight: 700;
            font-size: 11px;
            color: #000;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .acc-info-right {
            display: flex;
            gap: 4px;
            align-items: center;
        }
        
        .acc-qty-pill {
            background: #d35400;
            color: white;
            padding: 2px 4px;
            border-radius: 5px;
            font-size: 11px;
            font-weight: 700;
        }
        
        .acc-size-pill {
            background: #16a085;
            color: white;
            padding: 2px 4px;
            border-radius: 5px;
            font-size: 11px;
            font-weight: 700;
            margin-left: 3px;
        }
        
        .acc-color-pill {
            color: #666;
            font-size: 11px;
            background: #f5f5f5;
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        /* Curtain Notes Section - Full Width */
        .curtain-notes-section {
            background: #fffbf0;
            border: 1px solid #f39c12;
            border-radius: 3px;
            padding: 1px 3px;
            margin-top: 1px;
            width: 100%;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            gap: 3px;
        }
        
        .notes-header {
            font-size: 13px;
            font-weight: 700;
            color: #f39c12;
            display: flex;
            align-items: center;
            gap: 2px;
            white-space: nowrap;
        }
        
        .notes-icon {
            font-size: 14px;
        }
        
        .notes-content {
            font-size: 13px;
            color: #333;
            line-height: 1.3;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
        }
        
        /* === FOOTER === */
        .footer-section {
            margin-top: 3px;
            padding: 3px;
            background: #f8f5f0;
            border: 1px solid #a67c52;
            border-radius: 4px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            page-break-inside: avoid;
        }
        
        .page-number {
            text-align: center;
            font-size: 10px;
            color: #666;
            margin-top: 2px;
            page-break-inside: avoid;
        }
        
        .signature-box {
            text-align: center;
        }
        
        .sig-line {
            width: 70px;
            border-top: 2px solid #a67c52;
            margin: 0 auto 1px;
            padding-top: 1px;
        }
        
        .sig-label {
            font-size: 12px;
            font-weight: 700;
            color: #a67c52;
        }
        
        .sig-name {
            font-size: 11px;
            color: #666;
            margin-top: 0;
        }
        
        .print-btn {
            position: fixed;
            top: 15px;
            left: 15px;
            padding: 8px 16px;
            background: #a67c52;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            z-index: 1000;
            font-family: 'Cairo', sans-serif;
        }
        
        .print-btn:hover {
            background: #8b6f47;
        }
        
        @media print {
            .print-btn { display: none; }
            .contract-page { padding: 0; }
        }
    </style>
</head>
<body>
    <button class="print-btn" onclick="window.print()">üñ®Ô∏è ÿ∑ÿ®ÿßÿπÿ©</button>
    
    <!-- ÿßŸÑÿπŸÑÿßŸÖÿ© ÿßŸÑŸÖÿßÿ¶Ÿäÿ© -->
    <div class="watermark">
        <img src="{{ MEDIA_ROOT }}/company_logos/Logo_1080.png" alt="ÿπŸÑÿßŸÖÿ© ŸÖÿßÿ¶Ÿäÿ©">
    </div>
    
    <div class="contract-page">
        <!-- HEADER -->
        <div class="header-section">
            {% if settings.company_logo %}
            <div class="logo-box">
                <img src="{{ settings.company_logo.url }}" alt="ÿßŸÑÿ¥ÿπÿßÿ±">
            </div>
            {% endif %}
            
            <!-- Service Types (Right) -->
            <div class="header-right">
                {% if order.service_types and order.service_types|length > 0 %}
                    {% for service in order.service_types %}
                    <span class="service-badge badge-{{ service }}">
                        {% if service == 'tailoring' %}ÿ™ÿ≥ŸÑŸäŸÖ
                        {% elif service == 'installation' %}ÿ™ÿ±ŸÉŸäÿ®
                        {% elif service == 'accessory' %}ÿ•ŸÉÿ≥ÿ≥Ÿàÿßÿ±
                        {% elif service == 'products' %}ŸÖŸÜÿ™ÿ¨ÿßÿ™
                        {% elif service == 'inspection' %}ŸÖÿπÿßŸäŸÜÿ©
                        {% else %}{{ service }}{% endif %}
                    </span>
                    {% endfor %}
                    {% if total_meters %}
                    <div style="font-size: 11px; color: #666; margin-top: 3px; margin-right: 5px;">
                        ({{ total_meters|floatformat:2 }} ŸÖÿ™ÿ±)
                    </div>
                    {% endif %}
                {% endif %}
            </div>
            
            <!-- Contract Number (Center) -->
            <div class="header-center">
                <span class="contract-number-main" dir="ltr">
                    {{ order.order_number }}-{{ order.contract_number|default:"c1" }}
                </span>
            </div>
            
            <!-- Order Type/Status (Left) -->
            <div class="header-left">
                {% if order.status == 'vip' %}
                <span class="vip-badge">
                    <span class="vip-crown">üëë</span> VIP
                </span>
                {% else %}
                <span class="order-status-text">ÿπÿßÿØŸä</span>
                {% endif %}
            </div>
        </div>
        
        <!-- INFO CARDS -->
        <div class="cards-row">
            <!-- Order Info Card -->
            <div class="info-card">
                <div class="card-title">ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ∑ŸÑÿ®</div>
                <div class="card-row">
                    <div>
                        <span class="card-label">ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</span>
                        <span class="card-value">{{ order.invoice_number|default:"--" }}</span>
                    </div>
                    <div style="text-align: left;">
                        <span class="card-label">ÿπÿØÿØ ÿßŸÑÿ≥ÿ™ÿßÿ¶ÿ±</span>
                        <span class="curtain-count-badge">{{ curtains.count }}</span>
                    </div>
                </div>
                <div class="card-row">
                    <div>
                        <span class="card-label">ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ∑ŸÑÿ®</span>
                        <span class="card-value">{{ order.created_at|date:"Y/m/d" }}</span>
                    </div>
                    <div style="text-align: left;">
                        <span class="card-label">ÿßŸÑÿ™ÿ≥ŸÑŸäŸÖ ÿßŸÑŸÖÿ™ŸàŸÇÿπ</span>
                        <span class="card-value">
                            {% if order.expected_delivery_date %}
                                {{ order.expected_delivery_date|date:"Y/m/d" }}
                            {% else %}
                                ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ
                            {% endif %}
                        </span>
                    </div>
                </div>
                <div class="card-row">
                    <div style="width: 100%;">
                        <span class="card-label">ÿπÿØÿØ ÿ£ŸäÿßŸÖ ÿßŸÑÿ™ÿ¥ÿ∫ŸäŸÑ</span>
                        <span class="card-value">
                            {% if working_days %}{{ working_days }}{% else %}--{% endif %} ŸäŸàŸÖ
                        </span>
                    </div>
                </div>
            </div>
            
            <!-- Customer Card -->
            <div class="info-card">
                <div class="card-title">ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ</div>
                <div class="card-row">
                    <div>
                        <span class="card-label">ÿßŸÑÿπŸÖŸäŸÑ</span>
                        <span class="card-value">{{ order.customer.name }}</span>
                    </div>
                    <div style="text-align: left;">
                        <span class="card-label">ÿßŸÑŸáÿßÿ™ŸÅ</span>
                        <span class="card-value">{{ order.customer.phone|default:"--" }}</span>
                    </div>
                </div>
                <div class="card-row">
                    <div>
                        <span class="card-label">ÿßŸÑÿ®ÿßÿ¶ÿπ</span>
                        <span class="card-value">{{ order.salesperson.name|default:order.created_by.get_full_name|default:order.created_by.username }}</span>
                        {% if order.salesperson.phone %}
                        <span class="salesperson-phone">{{ order.salesperson.phone }}</span>
                        {% endif %}
                    </div>
                    <div style="text-align: left;">
                        <span class="card-label">ÿßŸÑŸÅÿ±ÿπ</span>
                        <span class="card-value">{{ order.branch.name|default:"--" }}</span>
                    </div>
                </div>
                <div class="card-row">
                    <div style="width: 100%;">
                        <span class="card-label">ÿßŸÑÿπŸÜŸàÿßŸÜ</span>
                        <span class="card-value">{{ order.customer.address|default:"ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ" }}</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- CURTAINS -->
        <div class="section-title">ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ≥ÿ™ÿßÿ¶ÿ±</div>
        
        {% for curtain in curtains %}
        <div class="curtain-row">
            <!-- Curtain Header -->
            <div class="curtain-header">
                <!-- Right: Number + Name -->
                <div class="curtain-name-box">
                    <span class="curtain-number">ÿ≥ÿ™ÿßÿ±ÿ© {{ forloop.counter }}:</span>
                    <span class="curtain-name">{{ curtain.room_name }}</span>
                </div>
                
                <!-- Contract Number Badge -->
                <div style="background: #f8f5f0; border: 1.5px solid #a67c52; border-radius: 4px; padding: 2px 8px; margin: 0 10px;">
                    <span style="font-size: 10px; font-weight: 700; color: #a67c52; letter-spacing: 0.5px; direction: ltr; display: inline-block;">{{ order.order_number }}-{{ order.contract_number|default:"c1" }}</span>
                </div>
                
                <!-- Center: Dimensions -->
                <div class="curtain-dimensions">
                    <div class="dim-item">
                        <span class="dim-label">ÿπÿ±ÿ∂:</span>
                        <span class="dim-badge">{{ curtain.width }}ŸÖ</span>
                    </div>
                    <div class="dim-item">
                        <span class="dim-label">ÿ∑ŸàŸÑ:</span>
                        <span class="dim-badge height-badge">{{ curtain.height }}ŸÖ</span>
                    </div>
                </div>
                
                <!-- Left: Type + Box Info -->
                <div class="curtain-extra-info">
                    {% if curtain.installation_type %}
                    <div class="curtain-type">{{ curtain.get_installation_type_display }}</div>
                    {% endif %}
                    {% if curtain.curtain_box_width or curtain.curtain_box_depth %}
                    <div class="box-dimensions">
                        <strong>ÿ®Ÿäÿ™:</strong>
                        {% if curtain.curtain_box_width %}{{ curtain.curtain_box_width|floatformat:0 }}{% endif %}
                        {% if curtain.curtain_box_width and curtain.curtain_box_depth %}√ó{% endif %}
                        {% if curtain.curtain_box_depth %}{{ curtain.curtain_box_depth|floatformat:0 }}{% endif %}ÿ≥ŸÖ
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Curtain Content -->
            <div class="curtain-content">
                <!-- Accessories -->
                <div class="accessories-section">
                    <div class="acc-title-text">
                        <span class="acc-icon-emoji">üîß</span> ÿßŸÑÿ•ŸÉÿ≥ÿ≥Ÿàÿßÿ±ÿßÿ™
                    </div>
                    {% if curtain.accessories.exists %}
                    <div class="accessories-items">
                        {% for accessory in curtain.accessories.all %}
                        <div class="accessory-row">
                            <div style="flex: 1;">
                                <span class="acc-name-text">{{ accessory.accessory_name }}</span>
                                {% if accessory.color %}
                                <div style="font-size: 13px; color: #666; margin-top: 2px;">
                                    <strong>ÿßŸÑŸÑŸàŸÜ:</strong> {{ accessory.color }}
                                </div>
                                {% endif %}
                            </div>
                            <div class="acc-info-right">
                                {% if accessory.size %}
                                <div style="text-align: center; margin-left: 10px;">
                                    <div style="font-size: 11px; color: #666; margin-bottom: 2px;">ŸÖŸÇÿßÿ≥</div>
                                    <span class="acc-size-pill">{{ accessory.size }}</span>
                                </div>
                                {% endif %}
                                <div style="text-align: center;">
                                    <div style="font-size: 11px; color: #666; margin-bottom: 2px;">ÿπÿØÿØ</div>
                                    <span class="acc-qty-pill">{{ accessory.quantity }}</span>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% else %}
                    <div style="text-align: center; padding: 10px; color: #999; font-size: 13px;">
                        ŸÑŸÖ Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿ•ŸÉÿ≥ÿ≥Ÿàÿßÿ±ÿßÿ™
                    </div>
                    {% endif %}
                </div>
                
                <!-- Fabrics -->
                <div class="fabric-section">
                    <div class="section-header">
                        <span class="section-icon">üé®</span> ÿßŸÑÿ£ŸÇŸÖÿ¥ÿ©
                    </div>
                    {% if curtain.fabrics.exists %}
                    {% for fabric in curtain.fabrics.all %}
                    <div class="fabric-block">
                        <div class="fabric-name-line">
                            {% if fabric.fabric_type == 'light' %}
                            <span class="fabric-type-badge light">ÿÆŸÅŸäŸÅ</span>
                            {% elif fabric.fabric_type == 'heavy' %}
                            <span class="fabric-type-badge heavy">ÿ´ŸÇŸäŸÑ</span>
                            {% elif fabric.fabric_type == 'blackout' %}
                            <span class="fabric-type-badge blackout">ÿ®ŸÑÿßŸÉ ÿ£Ÿàÿ™</span>
                            {% elif fabric.fabric_type == 'extra' %}
                            <span class="fabric-type-badge extra">ÿ•ÿ∂ÿßŸÅŸä</span>
                            {% elif fabric.fabric_type %}
                            <span class="fabric-type-badge light">{{ fabric.get_fabric_type_display }}</span>
                            {% endif %}
                            <span class="fabric-name-bold">{{ fabric.fabric_name|default:"ŸÇŸÖÿßÿ¥" }}</span>
                            <span class="fabric-meters">{{ fabric.meters }}ŸÖ</span>
                        </div>
                        <div class="fabric-specs">
                            <div class="fabric-spec-item large">
                                <span class="spec-label-text">ÿπÿØÿØ ÿßŸÑŸÇÿ∑ÿπ:</span> {{ fabric.pieces }}
                            </div>
                            {% if fabric.tailoring_type %}
                            <div class="fabric-spec-item large">
                                <span class="spec-label-text">ŸÜŸàÿπ ÿßŸÑÿ™ŸÅÿµŸäŸÑ:</span> {{ fabric.get_tailoring_type_display }}
                            </div>
                            {% endif %}
                        </div>
                        {% if fabric.notes %}
                        <div class="fabric-notes">
                            <strong>ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™:</strong> {{ fabric.notes }}
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                    {% else %}
                    <div style="text-align: center; padding: 10px; color: #999; font-size: 13px;">
                        ŸÑŸÖ Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿ£ŸÇŸÖÿ¥ÿ©
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Curtain Notes Section - Full Width Row -->
            {% if curtain.notes %}
            <div class="curtain-notes-section">
                <div class="notes-header">
                    <span class="notes-icon">üìù</span> ŸÖŸÑÿßÿ≠ÿ∏ÿ©:
                </div>
                <div class="notes-content">{{ curtain.notes }}</div>
            </div>
            {% endif %}
        </div>
        {% empty %}
        <div style="text-align: center; padding: 20px; color: #999;">
            ŸÑŸÖ Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿ≥ÿ™ÿßÿ¶ÿ± ŸÑŸáÿ∞ÿß ÿßŸÑÿπŸÇÿØ
        </div>
        {% endfor %}
        
        <!-- FOOTER -->
        <div class="footer-section">
            <div class="signature-box">
                <div class="sig-line"></div>
                <div class="sig-label">ÿ™ŸàŸÇŸäÿπ ÿßŸÑÿ®ÿßÿ¶ÿπ</div>
                <div class="sig-name">{{ order.salesperson.name|default:order.created_by.get_full_name|default:order.created_by.username }}</div>
            </div>
            
            <div class="signature-box">
                <div class="sig-line"></div>
                <div class="sig-label">ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©</div>
                <div class="sig-name">{% now "Y/m/d H:i" %}</div>
            </div>
        </div>
        
        <div class="page-number">
            <script>
                document.write('ÿµŸÅÿ≠ÿ© ' + '<span class="page"></span>' + ' ŸÖŸÜ ' + '<span class="pages"></span>');
            </script>
        </div>
    </div>
</body>
</html>
