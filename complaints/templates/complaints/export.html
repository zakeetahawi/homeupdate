{% extends 'base.html' %}
{% load static %}
{% block title %}تصدير الشكاوى - نظام الخواجه{% endblock %}
{% block extra_css %}<link rel="stylesheet" href="{% static 'css/complaints-module.css' %}?v={% now 'U' %}">{% endblock %}

{% block content %}
<div class="container-fluid cm-page">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="fas fa-file-export me-2"></i>تصدير الشكاوى</h2>
        <a href="{% url 'complaints:complaint_list' %}" class="btn btn-outline-secondary btn-sm"><i class="fas fa-arrow-right me-1"></i>العودة</a>
    </div>

    <div class="cm-card">
        <div class="cm-card-body">
            <form method="post">
                {% csrf_token %}

                {# Format #}
                <div class="border-bottom pb-3 mb-3">
                    <h6 class="fw-semibold mb-3"><i class="fas fa-file me-2"></i>صيغة التصدير</h6>
                    <div class="d-flex flex-wrap gap-3">
                        {% for value, label in form.export_format.field.choices %}
                        <label class="border rounded-3 px-4 py-3 text-center cursor-pointer export-opt {% if form.export_format.value == value %}border-primary bg-light{% endif %}" style="cursor:pointer;min-width:120px">
                            <input type="radio" name="{{ form.export_format.name }}" value="{{ value }}" class="d-none" {% if form.export_format.value == value %}checked{% endif %}>
                            <i class="fas fa-file-{{ value }} d-block mb-1 fs-4"></i>{{ label }}
                        </label>
                        {% endfor %}
                    </div>
                </div>

                {# Date range #}
                <div class="border-bottom pb-3 mb-3">
                    <h6 class="fw-semibold mb-3"><i class="fas fa-calendar me-2"></i>نطاق التاريخ</h6>
                    <div class="row g-3">
                        <div class="col-md-6"><label class="form-label">{{ form.date_from.label }}</label>{{ form.date_from }}</div>
                        <div class="col-md-6"><label class="form-label">{{ form.date_to.label }}</label>{{ form.date_to }}</div>
                    </div>
                </div>

                {# Status #}
                <div class="border-bottom pb-3 mb-3">
                    <h6 class="fw-semibold mb-3">{{ form.status.label }}</h6>
                    <div class="row g-2">{{ form.status }}</div>
                </div>

                {# Complaint type #}
                <div class="border-bottom pb-3 mb-3">
                    <h6 class="fw-semibold mb-3">{{ form.complaint_type.label }}</h6>
                    <div class="row g-2">{{ form.complaint_type }}</div>
                </div>

                {# Priority #}
                <div class="border-bottom pb-3 mb-3">
                    <h6 class="fw-semibold mb-3">{{ form.priority.label }}</h6>
                    <div class="row g-2">{{ form.priority }}</div>
                </div>

                <div class="d-flex justify-content-between mt-4">
                    <button type="reset" class="btn btn-outline-secondary btn-sm" id="resetBtn"><i class="fas fa-undo me-1"></i>إعادة تعيين</button>
                    <button type="submit" class="btn btn-primary"><i class="fas fa-file-export me-1"></i>تصدير</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded',function(){
    var opts=document.querySelectorAll('.export-opt');
    opts.forEach(function(o){o.addEventListener('click',function(){opts.forEach(function(x){x.classList.remove('border-primary','bg-light')});this.classList.add('border-primary','bg-light');this.querySelector('input').checked=true})});
    document.getElementById('resetBtn').addEventListener('click',function(e){e.preventDefault();document.querySelector('form').reset();opts.forEach(function(x){x.classList.remove('border-primary','bg-light')});opts[0].classList.add('border-primary','bg-light')});
});
</script>
{% endblock %}
