# ๐ง ุญู ูุดููุฉ: ุญุฐู ุงูุฃูุณุงู ุจุนุฏ Migration

## โ **ุงููุดููุฉ**

ุนูุฏ ุชูููุฐ ุฃู migration (ูู ุฃู app)ุ ุชุฎุชูู ุงูุฃูุณุงู ุงููุฎุตุตุฉ ุงูุชู ุชู ุชุนููููุง ูููุณุชุฎุฏููู!

### **ุงูุณุจุจ:**

ูู ููู [accounts/signals/post_migrate.py](accounts/signals/post_migrate.py)ุ ููุฌุฏ signal ูุนูู ุจุนุฏ **ูู** migration:

```python
@receiver(post_migrate)
def create_core_departments_after_migrate(sender, **kwargs):
    if sender.name == 'accounts':
        from accounts.core_departments import create_core_departments
        create_core_departments()
```

ูุงูุฏุงูุฉ `create_core_departments()` ูู [accounts/core_departments.py](accounts/core_departments.py) ูุงูุช ุชุญุฐู **ุฌููุน ุงูุฃูุณุงู** ุงูุชู ููุณุช ูู ุงููุงุฆูุฉ ุงูุฃุณุงุณูุฉ:

```python
# ุญุฐู ุฌููุน ุงูุฃูุณุงู ุงูุชู ููุณุช ูู ุงููุงุฆูุฉ ุงูุญููููุฉ
fake_departments = Department.objects.exclude(code__in=real_departments)
deleted_count = fake_departments.count()
fake_departments.delete()  # โ ูุฐุง ูุญุฐู ุงูุฃูุณุงู ุงููุฎุตุตุฉ!
```

---

## โ **ุงูุญู ุงููุทุจู**

### **1. ุชุนุทูู ุงูุญุฐู ุงูุชููุงุฆู**

ุชู ุชุนุทูู ููุฏ ุญุฐู ุงูุฃูุณุงู ุงูุฅุถุงููุฉ ูู `create_core_departments()`:

```python
# โ๏ธ ุชู ุชุนุทูู ุญุฐู ุงูุฃูุณุงู ุงูุฅุถุงููุฉ ููุญูุงุธ ุนูู ุงูุฃูุณุงู ุงููุฎุตุตุฉ
# ุฅุฐุง ููุช ุชุฑูุฏ ุญุฐู ุงูุฃูุณุงู ุงูุฅุถุงููุฉุ ุงุณุชุฎุฏู ุงูุฃูุฑ: python manage.py cleanup_departments

# ุงูููุฏ ุงููุฏูู (ูุนุทู):
# fake_departments = Department.objects.exclude(code__in=real_departments)
# fake_departments.delete()
```

### **2. ุฃูุฑ ูุฏูู ููุญุฐู ุนูุฏ ุงูุญุงุฌุฉ**

ุฅุฐุง ููุช ุชุฑูุฏ ุญุฐู ุงูุฃูุณุงู ุงูุฅุถุงููุฉุ ุงุณุชุฎุฏู ุงูุฃูุฑ:

```bash
# ูุนุงููุฉ ูุง ุณูุชู ุญุฐูู (dry-run)
python manage.py cleanup_departments --dry-run

# ุญุฐู ูุนูู (ูุน ุทูุจ ุชุฃููุฏ)
python manage.py cleanup_departments

# ุญุฐู ุจุฏูู ุชุฃููุฏ
python manage.py cleanup_departments --force
```

---

## ๐ **ุงููุชูุฌุฉ**

### **ูุจู ุงูุฅุตูุงุญ:**
```bash
python manage.py migrate accounting
# ุงููุชูุฌุฉ:
# โ ุชู ุชุทุจูู Migration
# โ ุชู ุญุฐู 30 ูุณู/ุฅุฏุงุฑุฉ ุฅุถุงููุฉ  โ ุงููุดููุฉ!
```

### **ุจุนุฏ ุงูุฅุตูุงุญ:**
```bash
python manage.py migrate accounting
# ุงููุชูุฌุฉ:
# โ ุชู ุชุทุจูู Migration
# โ ุชู ุงูุชุฃูุฏ ูู ูุฌูุฏ 9 ูุณู ุฃุณุงุณู
# โน๏ธ  ุฅููุงู ุงูุนูููุงุช...
# โ ุงูุฃูุณุงู ุงููุฎุตุตุฉ ูุญููุธุฉ!
```

---

## ๐ **ุงูุงุณุชุฎุฏุงู ุงูุตุญูุญ**

### **ุญุงูุฉ 1: Migration ุนุงุฏู**
```bash
python manage.py migrate
# โ ูู ูุชู ุญุฐู ุฃู ุฃูุณุงู ูุฎุตุตุฉ
```

### **ุญุงูุฉ 2: ุชูุธูู ุงูุฃูุณุงู ูุฏููุงู**
```bash
# ูุนุงููุฉ ุฃููุงู
python manage.py cleanup_departments --dry-run

# ุฅุฐุง ููุช ูุชุฃูุฏุงูุ ุงุญุฐู
python manage.py cleanup_departments
```

### **ุญุงูุฉ 3: ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุฃูุณุงู ุงูุฃุณุงุณูุฉ ููุท**
```bash
python manage.py create_core_departments
# โ ุณููุดุฆ/ูุญุฏุซ ุงูุฃูุณุงู ุงูุฃุณุงุณูุฉ ููุท
# โ ูู ูุญุฐู ุงูุฃูุณุงู ุงููุฎุตุตุฉ
```

---

## ๐ **ููุงุญุธุงุช ูููุฉ**

### **ุงูุฃูุณุงู ุงูุฃุณุงุณูุฉ (ูู ุชูุญุฐู ุฃุจุฏุงู):**
- customers (ุงูุนููุงุก)
- orders (ุงูุทูุจุงุช)
- inventory (ุงููุฎุฒูู)
- inspections (ุงููุญูุตุงุช)
- installations (ุงูุชุฑููุจุงุช)
- factory (ุงููุตูุน)
- complaints (ุงูุดูุงูู)
- reports (ุงูุชูุงุฑูุฑ)
- data_management (ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช)

### **ุงูุฃูุณุงู ุงููุฎุตุตุฉ (ูุญููุธุฉ ุงูุขู):**
- ุฃู ูุณู ุฅุถุงูู ุชู ุฅูุดุงุคู
- ุงูุฃูุณุงู ุงููุฑุชุจุทุฉ ุจูุณุชุฎุฏููู
- ุงูุฃูุณุงู ุงูุชู ุชุญุชูู ุนูู ุตูุญุงุช

---

## ๐ก๏ธ **ุงูุญูุงูุฉ ูู ุงููุดููุฉ**

### **ูุง ุชู ุชุทุจููู:**
1. โ ุชุนุทูู ุงูุญุฐู ุงูุชููุงุฆู
2. โ ุฅุถุงูุฉ ุชุญุฐูุฑุงุช ูุงุถุญุฉ
3. โ ุฃูุฑ ูููุตู ููุญุฐู ุงููุฏูู
4. โ ุฎูุงุฑ dry-run ูููุนุงููุฉ
5. โ ุทูุจ ุชุฃููุฏ ูุจู ุงูุญุฐู

### **ุงูุชูุตูุงุช:**
- โ๏ธ ูุง ุชุณุชุฎุฏู `cleanup_departments` ุฅูุง ุฅุฐุง ููุช ูุชุฃูุฏุงู
- โ ุงุณุชุฎุฏู `--dry-run` ุฏุงุฆูุงู ูููุนุงููุฉ ุฃููุงู
- โ ุงุญุชูุธ ุจูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจู ุงูุชูุธูู

---

## ๐ **ุงุณุชูุดุงู ุงูุฃุฎุทุงุก**

### **ุงูุณุคุงู: "ุฃูุณุงูู ูุงุฒุงูุช ุชุฎุชูู!"**

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุชุทุจูู ุงูุฅุตูุงุญ:
   ```bash
   git pull origin main
   # ุฃู ุชุฃูุฏ ูู ุฃู accounts/core_departments.py ูุญุฏุซ
   ```

2. ุฃุนุฏ ุชุดุบูู migration:
   ```bash
   python manage.py migrate
   ```

3. ุฃุนุฏ ุฅูุดุงุก ุงูุฃูุณุงู ุงูููููุฏุฉ:
   ```bash
   # ูู Django Admin:
   # Accounts โ Departments โ Add Department
   ```

---

## ๐ **ุงูุชุงุฑูุฎ**

- **ุงูุชุงุฑูุฎ:** 23 ุฏูุณูุจุฑ 2025
- **ุงูุฅุตุฏุงุฑ:** 1.1.0
- **ุงูุญุงูุฉ:** โ ุชู ุงูุฅุตูุงุญ

---

## ๐ก **ุฎูุงุตุฉ**

**ูุจู:** Migration โ ุญุฐู ุชููุงุฆู ููุฃูุณุงู ุงููุฎุตุตุฉ โ  
**ุจุนุฏ:** Migration โ ุงูุญูุงุธ ุนูู ุงูุฃูุณุงู ุงููุฎุตุตุฉ โ

ุงูุขู ููููู ุฅุถุงูุฉ ุฃูุณุงู ูุฎุตุตุฉ ุฏูู ุงูููู ูู ุงุฎุชูุงุฆูุง ุจุนุฏ ุฃู migration!
